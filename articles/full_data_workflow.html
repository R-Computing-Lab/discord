<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Full Data Workflow • discord</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Full Data Workflow">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">discord</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/categorical_predictors.html">Handling categorical predictors with discord</a></li>
    <li><a class="dropdown-item" href="../articles/full_data_workflow.html">Full Data Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/links.html">No Database? No Problem: Using discord with Simple Family Structures</a></li>
    <li><a class="dropdown-item" href="../articles/plots.html">Plots</a></li>
    <li><a class="dropdown-item" href="../articles/Power.html">Power</a></li>
    <li><a class="dropdown-item" href="../articles/regression.html">NLSY: Regression demonstration with Flu Vaccination and SES data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-Computing-Lab/discord/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Full Data Workflow</h1>
                        <h4 data-toc-skip class="author">S. Mason
Garrison</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/R-Computing-Lab/discord/blob/main/vignettes/full_data_workflow.Rmd" class="external-link"><code>vignettes/full_data_workflow.Rmd</code></a></small>
      <div class="d-none name"><code>full_data_workflow.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette provides a complete workflow for conducting
discordant-kinship regression using the {discord} package. We encourage
you to read the accompanying paper (Garrison et al., 2025) for a full
explanation of the methods and their applications. Here, we demonstrate
how to transform your data from its original structure into a format
suitable for analysis, then walk through both standard OLS regression
(for comparison) and discordant-kinship regression.</p>
<p>The tutorial covers three common starting data structures: wide
format, long format, and pedigree data. We show how to prepare each for
analysis using simulated data for reproducibility. You can adapt our
analysis pipeline to your own data by substituting your variables and
kinship links.</p>
</div>
<div class="section level2">
<h2 id="data-structures-and-preparation">Data Structures and Preparation<a class="anchor" aria-label="anchor" href="#data-structures-and-preparation"></a>
</h2>
<p>Your data likely exists in one of three common formats (wide, long,
or pedigree). Regardless of starting point, the goal is to create
wide-format data where each row represents a kinship pair, with
variables for each member of the pair distinguished by suffixes (e.g.,
<code>_1</code> and <code>_2</code>). Understanding your data structure
determines which transformation steps you’ll need.</p>
<div class="section level3">
<h3 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h3>
<p>First, load the necessary packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For easy data manipulation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># For kinship linkages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlsy-links.github.io/NlsyLinks/" class="external-link">NlsyLinks</a></span><span class="op">)</span></span>
<span><span class="co"># For discordant-kinship regression</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/R-Computing-Lab/discord" class="external-link">discord</a></span><span class="op">)</span></span>
<span><span class="co"># To clean data frames</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor" class="external-link">janitor</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/" class="external-link">broom</a></span><span class="op">)</span></span>
<span><span class="co"># For pipe</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="co"># For pedigree data manipulation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/R-Computing-Lab/BGmisc/" class="external-link">BGmisc</a></span><span class="op">)</span></span>
<span><span class="co"># For pedigree plotting</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/R-Computing-Lab/ggpedigree/" class="external-link">ggpedigree</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="wide-format-data">Wide Format Data<a class="anchor" aria-label="anchor" href="#wide-format-data"></a>
</h3>
<p>Wide format is the most direct structure for our analysis. Each row
represents one kinship pair, with variables appearing twice—once for
each member of the pair—using suffixes to distinguish the two
individuals. You’ll see columns like <code>age_s1</code> and
<code>age_s2</code>, where <code>_s1</code> and <code>_s2</code>
identify which sibling’s data appears in each column.</p>
<p>Here’s an example with simulated sibling data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_wide</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  pid <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,</span>
<span>  id_s1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">101</span>, <span class="fl">201</span>, <span class="fl">301</span>, <span class="fl">401</span>, <span class="fl">501</span><span class="op">)</span>,</span>
<span>  id_s2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">102</span>, <span class="fl">202</span>, <span class="fl">302</span>, <span class="fl">402</span>, <span class="fl">502</span><span class="op">)</span>,</span>
<span>  age_s1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">27</span>, <span class="fl">40</span>, <span class="fl">36</span>, <span class="fl">30</span><span class="op">)</span>,</span>
<span>  age_s2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">28</span>, <span class="fl">25</span>, <span class="fl">38</span>, <span class="fl">35</span>, <span class="fl">28</span><span class="op">)</span>,</span>
<span>  height_s1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">175</span>, <span class="fl">160</span>, <span class="fl">180</span>, <span class="fl">170</span>, <span class="fl">165</span><span class="op">)</span>,</span>
<span>  height_s2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">170</span>, <span class="fl">162</span>, <span class="fl">178</span>, <span class="fl">172</span>, <span class="fl">168</span><span class="op">)</span>,</span>
<span>  weight_s1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">70</span>, <span class="fl">60</span>, <span class="fl">80</span>, <span class="fl">75</span>, <span class="fl">65</span><span class="op">)</span>,</span>
<span>  weight_s2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">68</span>, <span class="fl">62</span>, <span class="fl">78</span>, <span class="fl">74</span>, <span class="fl">66</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df_wide</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="5%">
<col width="8%">
<col width="8%">
<col width="10%">
<col width="10%">
<col width="14%">
<col width="14%">
<col width="14%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="right">pid</th>
<th align="right">id_s1</th>
<th align="right">id_s2</th>
<th align="right">age_s1</th>
<th align="right">age_s2</th>
<th align="right">height_s1</th>
<th align="right">height_s2</th>
<th align="right">weight_s1</th>
<th align="right">weight_s2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">101</td>
<td align="right">102</td>
<td align="right">30</td>
<td align="right">28</td>
<td align="right">175</td>
<td align="right">170</td>
<td align="right">70</td>
<td align="right">68</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">201</td>
<td align="right">202</td>
<td align="right">27</td>
<td align="right">25</td>
<td align="right">160</td>
<td align="right">162</td>
<td align="right">60</td>
<td align="right">62</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">301</td>
<td align="right">302</td>
<td align="right">40</td>
<td align="right">38</td>
<td align="right">180</td>
<td align="right">178</td>
<td align="right">80</td>
<td align="right">78</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">401</td>
<td align="right">402</td>
<td align="right">36</td>
<td align="right">35</td>
<td align="right">170</td>
<td align="right">172</td>
<td align="right">75</td>
<td align="right">74</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">501</td>
<td align="right">502</td>
<td align="right">30</td>
<td align="right">28</td>
<td align="right">165</td>
<td align="right">168</td>
<td align="right">65</td>
<td align="right">66</td>
</tr>
</tbody>
</table>
<p>In this example, <code>pid</code> is a unique identifier for each
sibling pair. Specifically, each row is anchored by a pair identifier.
Variables ending in <code>_s1</code> refer to one sibling, while those
ending in <code>_s2</code> refer to the other. In this case, the dataset
is already arranged so that the older sibling is <code>_s1</code> and
the younger is <code>_s2</code>, but this ordering will be adjusted
later based on the outcome variable. If your data already has this
structure, you can skip ahead to the “Ordering and Derived Variables”
section.</p>
</div>
<div class="section level3">
<h3 id="long-format-data-example">Long Format Data Example<a class="anchor" aria-label="anchor" href="#long-format-data-example"></a>
</h3>
<p>Long format structures data with one row per individual. In other
words, each person appears in their own row, with a pair identifier
column linking siblings together. This format is common in many
datasets, particularly those downloaded from data repositories, but
requires transformation for our analysis. For example, the NLSY datasets
by default provide data in long format.</p>
<p>We can demonstrate long format by reshaping our wide data from
above:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_long</span> <span class="op">&lt;-</span> <span class="va">df_wide</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="op">-</span><span class="va">pid</span>, <span class="co"># keep the dyad identifier intact</span></span>
<span>    names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">".value"</span>, <span class="st">"sibling"</span><span class="op">)</span>, <span class="co"># split base names and the sibling marker</span></span>
<span>    names_sep <span class="op">=</span> <span class="st">"_s"</span> <span class="co"># original suffix delimiter in column names</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">df_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">pid</th>
<th align="left">sibling</th>
<th align="right">id</th>
<th align="right">age</th>
<th align="right">height</th>
<th align="right">weight</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">1</td>
<td align="right">101</td>
<td align="right">30</td>
<td align="right">175</td>
<td align="right">70</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">2</td>
<td align="right">102</td>
<td align="right">28</td>
<td align="right">170</td>
<td align="right">68</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">1</td>
<td align="right">201</td>
<td align="right">27</td>
<td align="right">160</td>
<td align="right">60</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">2</td>
<td align="right">202</td>
<td align="right">25</td>
<td align="right">162</td>
<td align="right">62</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">1</td>
<td align="right">301</td>
<td align="right">40</td>
<td align="right">180</td>
<td align="right">80</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">2</td>
<td align="right">302</td>
<td align="right">38</td>
<td align="right">178</td>
<td align="right">78</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">1</td>
<td align="right">401</td>
<td align="right">36</td>
<td align="right">170</td>
<td align="right">75</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">2</td>
<td align="right">402</td>
<td align="right">35</td>
<td align="right">172</td>
<td align="right">74</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">1</td>
<td align="right">501</td>
<td align="right">30</td>
<td align="right">165</td>
<td align="right">65</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="left">2</td>
<td align="right">502</td>
<td align="right">28</td>
<td align="right">168</td>
<td align="right">66</td>
</tr>
</tbody>
</table>
<p>Notice how each individual now occupies their own row, with the
<code>sibling</code> column indicating whether they were originally
labeled <code>1</code> or <code>2</code>. The <code>pid</code> column
still identifies which individuals form a pair.</p>
<p>If your data does not already have a unique identifier for each
kinship pair, you may need to construct your own based on the available
information or download one from a kinship linkage resources. Ideally,
you will also have information about the type of kinship (e.g., full
siblings, half-siblings, cousins) and whether they were raised together
or apart. (More on how to do this below for pedigree data.)</p>
<div class="section level4">
<h4 id="converting-long-to-wide">Converting Long to Wide<a class="anchor" aria-label="anchor" href="#converting-long-to-wide"></a>
</h4>
<p>To convert long format data for discordant-kinship analysis, use
<code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider()</a></code> from the {tidyr} package:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_long2wide</span> <span class="op">&lt;-</span> <span class="va">df_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">sibling</span>, <span class="co"># the column that indicates the sibling number</span></span>
<span>    values_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">age</span>, <span class="va">height</span>, <span class="va">weight</span><span class="op">)</span>, <span class="co"># variables to spread into paired columns</span></span>
<span>    names_sep <span class="op">=</span> <span class="st">"_s"</span> <span class="co"># ensures id_s1, id_s2,etc</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">df_long2wide</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="5%">
<col width="8%">
<col width="8%">
<col width="10%">
<col width="10%">
<col width="14%">
<col width="14%">
<col width="14%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="right">pid</th>
<th align="right">id_s1</th>
<th align="right">id_s2</th>
<th align="right">age_s1</th>
<th align="right">age_s2</th>
<th align="right">height_s1</th>
<th align="right">height_s2</th>
<th align="right">weight_s1</th>
<th align="right">weight_s2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">101</td>
<td align="right">102</td>
<td align="right">30</td>
<td align="right">28</td>
<td align="right">175</td>
<td align="right">170</td>
<td align="right">70</td>
<td align="right">68</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">201</td>
<td align="right">202</td>
<td align="right">27</td>
<td align="right">25</td>
<td align="right">160</td>
<td align="right">162</td>
<td align="right">60</td>
<td align="right">62</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">301</td>
<td align="right">302</td>
<td align="right">40</td>
<td align="right">38</td>
<td align="right">180</td>
<td align="right">178</td>
<td align="right">80</td>
<td align="right">78</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">401</td>
<td align="right">402</td>
<td align="right">36</td>
<td align="right">35</td>
<td align="right">170</td>
<td align="right">172</td>
<td align="right">75</td>
<td align="right">74</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">501</td>
<td align="right">502</td>
<td align="right">30</td>
<td align="right">28</td>
<td align="right">165</td>
<td align="right">168</td>
<td align="right">65</td>
<td align="right">66</td>
</tr>
</tbody>
</table>
<p>The reshaped data now reproduces our original wide format. Each
analytic variable appears twice with <code>_s1</code> and
<code>_s2</code> suffixes, and the pair identifier <code>pid</code>
anchors each row.</p>
</div>
<div class="section level4">
<h4 id="using-existing-kinship-links">Using existing kinship links<a class="anchor" aria-label="anchor" href="#using-existing-kinship-links"></a>
</h4>
<p>As mentioned before, if your long-format data lacks pair identifiers,
you’ll need to create them using family IDs, household identifiers, or
external kinship resources. This process can be straightforward if you
have access to family or household identifiers, and are confident in the
kinship relationships. However, it can be more complex if the
relationships are not clearly defined or if there are multiple types of
kinship (e.g., siblings, cousins, half-siblings) in your data.</p>
<p>For NLSY data specifically, the {NlsyLinks} package provides
validated kinship links for the vast majority of dyads in the NLSY79 and
NLSY97 cohorts. These links are provided in wide format, and can be used
to left-join with the long-format data that the NLSY info website
provides. See the {NlsyLinks} documentation for more details on how to
access and use these datasets, or the reproducible source code for the
analyses in the primary paper (Garrison et al., 2025).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlsy-links.github.io/NlsyLinks/" class="external-link">NlsyLinks</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Links79PairExpanded</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Links79PairExpanded</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">ExtendedID</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">RelationshipPath</span> <span class="op">==</span> <span class="st">"Gen1Housemates"</span> <span class="op">&amp;</span> <span class="va">RFull</span> <span class="op">==</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>    <span class="va">ExtendedID</span>,</span>
<span>    <span class="va">SubjectTag_S1</span>, <span class="va">SubjectTag_S2</span>,</span>
<span>    <span class="va">RelationshipPath</span>, <span class="va">RFull</span>, <span class="va">IsMz</span>,</span>
<span>    <span class="va">EverSharedHouse</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="13%">
<col width="16%">
<col width="16%">
<col width="20%">
<col width="7%">
<col width="6%">
<col width="19%">
</colgroup>
<thead><tr class="header">
<th align="right">ExtendedID</th>
<th align="right">SubjectTag_S1</th>
<th align="right">SubjectTag_S2</th>
<th align="left">RelationshipPath</th>
<th align="right">RFull</th>
<th align="left">IsMz</th>
<th align="left">EverSharedHouse</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">3</td>
<td align="right">300</td>
<td align="right">400</td>
<td align="left">Gen1Housemates</td>
<td align="right">0.5</td>
<td align="left">No</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">500</td>
<td align="right">600</td>
<td align="left">Gen1Housemates</td>
<td align="right">0.5</td>
<td align="left">No</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="right">1300</td>
<td align="right">1400</td>
<td align="left">Gen1Housemates</td>
<td align="right">0.5</td>
<td align="left">No</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="right">17</td>
<td align="right">1700</td>
<td align="right">1800</td>
<td align="left">Gen1Housemates</td>
<td align="right">0.5</td>
<td align="left">No</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="right">2000</td>
<td align="right">2100</td>
<td align="left">Gen1Housemates</td>
<td align="right">0.5</td>
<td align="left">No</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
<p>As you can see, this dataset includes an extended family identifier
(<code>ExtendedID</code>), individual IDs for each sibling in the pair
(<code>R0000100</code> and <code>R0000200</code>), and their
RelationshipPath (<code>RelationshipPath</code> = “Gen1Housemates” and
genetic relatedness (<code>RFull</code> = 0.5). You can merge this
dataset with your long-format data using the individual IDs.</p>
<p>At this stage the long‑origin data are indistinguishable from the
original wide example. Each analytic variable now appears exactly
twice—once for <code>_s1</code> and once for <code>_s2</code>—and the
dyad identifier <code>pid</code> continues to anchor the row. You can
proceed directly to ordering and construction of <code>*_mean</code> and
<code>*_diff</code> with <code><a href="../reference/discord_data.html">discord_data()</a></code>.</p>
</div>
</div>
<div class="section level3">
<h3 id="pedigree-data">Pedigree Data<a class="anchor" aria-label="anchor" href="#pedigree-data"></a>
</h3>
<p>Pedigree data is common in genetic and family studies, where detailed
family trees are available. It is long format data that provides rich
information about familial relationships, such as (mother ID, father ID,
spouse ID). Our research team has developed specialized tools in the
{BGmisc} package to extract kinship links and transform these pedigree
structures into a wide format suitable for analysis. Below is an example
of how such a dataset might look in both tabular and graphical
forms:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">potter</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r-computing-lab.github.io/ggpedigree/reference/ggPedigree.html" class="external-link">ggpedigree</a></span><span class="op">(</span><span class="va">potter</span>, config <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  label_method <span class="op">=</span> <span class="st">"geom_text"</span>,</span>
<span>  label_nudge_y <span class="op">=</span> <span class="fl">.25</span>,</span>
<span>  focal_fill_personID <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  focal_fill_include <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  focal_fill_force_zero <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  focal_fill_na_value <span class="op">=</span> <span class="st">"grey50"</span>,</span>
<span>  focal_fill_low_color <span class="op">=</span> <span class="st">"darkred"</span>,</span>
<span>  focal_fill_high_color <span class="op">=</span> <span class="st">"gold"</span>,</span>
<span>  focal_fill_mid_color <span class="op">=</span> <span class="st">"orange"</span>,</span>
<span>  focal_fill_scale_midpoint <span class="op">=</span> <span class="fl">.65</span>,</span>
<span>  focal_fill_component <span class="op">=</span> <span class="st">"additive"</span>,</span>
<span>  focal_fill_method <span class="op">=</span> <span class="st">"steps"</span>, <span class="co">#</span></span>
<span>  <span class="co"># focal_fill_method = "viridis_c",</span></span>
<span>  focal_fill_use_log <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  focal_fill_n_breaks <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  sex_color_include <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  focal_fill_legend_title <span class="op">=</span> <span class="st">"Genetic Relatives \nof Harry Potter"</span></span>
<span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Potter Pedigree Plot"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="full_data_workflow_files/figure-html/unnamed-chunk-6-1.png" alt="Pedigree plot of the Potter dataset" width="480"><p class="caption">
Pedigree plot of the Potter dataset
</p>
</div>
<p>The pedigree tree above illustrates the family relationships among
individuals in the Potter dataset. Each node represents an individual,
and the lines connecting them indicate familial relationships such as
parent-child and sibling connections.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">potter</span><span class="op">)</span></span>
<span><span class="va">df_ped</span> <span class="op">&lt;-</span> <span class="va">potter</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>    <span class="va">personID</span>, <span class="va">sex</span>, <span class="va">famID</span>, <span class="va">momID</span>, <span class="va">dadID</span>, <span class="va">spouseID</span>,</span>
<span>    <span class="va">twinID</span>, <span class="va">zygosity</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>x_var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_ped</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">personID</th>
<th align="right">sex</th>
<th align="right">famID</th>
<th align="right">momID</th>
<th align="right">dadID</th>
<th align="right">spouseID</th>
<th align="right">twinID</th>
<th align="left">zygosity</th>
<th align="right">x_var</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">101</td>
<td align="right">102</td>
<td align="right">3</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">-1.40</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">101</td>
<td align="right">102</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">0.26</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">103</td>
<td align="right">104</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">-2.44</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">103</td>
<td align="right">104</td>
<td align="right">5</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">-0.01</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">4</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">0.62</td>
</tr>
</tbody>
</table>
<p>As you can see, each individual is represented in a separate row,
with columns for their unique identifier, mother’s identifier, father’s
identifier, and other relevant variables.</p>
<p>{BGmisc} is available on CRAN and GitHub. It can create kinship links
existing pedigree information.</p>
<p>To transform this data into a wide format suitable for
discordant-kinship regression, we need to create kinship links based on
the pedigree information. To extract the necessary kinship information,
we need to compute two matrices: the additive genetic relatedness matrix
and the shared environment matrix. Other matrices, such as
mitochondrial, can also be computed if needed.</p>
<p>Using {BGmisc}, we compute:</p>
<ul>
<li><p>The additive genetic relatedness matrix (add).</p></li>
<li><p>The shared environment matrix (cn), indicating whether kin were
raised together (1) or apart (0).</p></li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">add</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-computing-lab.github.io/BGmisc/reference/ped2add.html" class="external-link">ped2add</a></span><span class="op">(</span><span class="va">df_ped</span><span class="op">)</span></span>
<span><span class="va">cn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-computing-lab.github.io/BGmisc/reference/ped2cn.html" class="external-link">ped2cn</a></span><span class="op">(</span><span class="va">df_ped</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="https://r-computing-lab.github.io/BGmisc/reference/ped2add.html" class="external-link">ped2add()</a></code> function computes the additive genetic
relatedness matrix, which quantifies the genetic similarity between
individuals based on their pedigree information. The
<code><a href="https://r-computing-lab.github.io/BGmisc/reference/ped2cn.html" class="external-link">ped2cn()</a></code> function computes the shared environment matrix,
which indicates whether individuals were raised in the same environment
(1) or different environments (0).</p>
<p>The resulting matrices are symmetric, with diagonal elements
representing self-relatedness (1.0). The off-diagonal elements represent
the relatedness between pairs of individuals, with values ranging from 0
(no relatedness) to 0.5 (full siblings) to 1 (themselves).</p>
<p>We convert the component matrices into a wide-form dataframe of kin
pairs using <code><a href="https://r-computing-lab.github.io/BGmisc/reference/com2links.html" class="external-link">com2links()</a></code>. Self-pairs and duplicate entries
are removed.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_links</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-computing-lab.github.io/BGmisc/reference/com2links.html" class="external-link">com2links</a></span><span class="op">(</span></span>
<span>  writetodisk <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ad_ped_matrix <span class="op">=</span> <span class="va">add</span>,</span>
<span>  cn_ped_matrix <span class="op">=</span> <span class="va">cn</span>,</span>
<span>  drop_upper_triangular <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ID1</span> <span class="op">!=</span> <span class="va">ID2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_links</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">ID1</th>
<th align="right">ID2</th>
<th align="right">addRel</th>
<th align="right">cnuRel</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">0.50</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">4</td>
<td align="right">0.50</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">6</td>
<td align="right">0.50</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">6</td>
<td align="right">0.25</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">6</td>
<td align="right">0.50</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>As you can see, the <code>df_links</code> data frame contains pairs
of individuals (ID1 and ID2) along with their additive genetic
relatedness (<code>addRel</code>) and shared environment status
(<code>cnuRel</code>). These data are in wide format, with each row
representing a unique pair of individuals.</p>
<p>Further, we can tally the number of pairs by relatedness and shared
environment to understand the composition of the dataset.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_links</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">addRel</span>, <span class="va">cnuRel</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">tally</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">addRel</th>
<th align="right">cnuRel</th>
<th align="right">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.0625</td>
<td align="right">0</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">0.1250</td>
<td align="right">0</td>
<td align="right">47</td>
</tr>
<tr class="odd">
<td align="right">0.2500</td>
<td align="right">0</td>
<td align="right">104</td>
</tr>
<tr class="even">
<td align="right">0.5000</td>
<td align="right">0</td>
<td align="right">50</td>
</tr>
<tr class="odd">
<td align="right">0.5000</td>
<td align="right">1</td>
<td align="right">32</td>
</tr>
</tbody>
</table>
<p>This table shows the number of kinship pairs for each combination of
genetic relatedness and shared environment status. Although the discord
regression model can be used with any kin group, it is most
interpretable when there is a single kinship group.</p>
<p>For demonstration, we’ll focus on first cousins raised in separate
homes from our pedigree data. This subset allows us to illustrate the
process clearly.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2024</span><span class="op">)</span></span>
<span><span class="va">df_cousin</span> <span class="op">&lt;-</span> <span class="va">df_links</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">addRel</span> <span class="op">==</span> <span class="fl">.125</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># only cousins %&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cnuRel</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># only kin raised in separate homes</span></span>
<span></span>
<span><span class="va">df_synthetic</span> <span class="op">&lt;-</span> <span class="fu">discord</span><span class="fu">::</span><span class="fu"><a href="../reference/kinsim.html">kinsim</a></span><span class="op">(</span></span>
<span>  mu_all <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  cov_a <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>  cov_c <span class="op">=</span> <span class="fl">.1</span>,</span>
<span>  cov_e <span class="op">=</span> <span class="fl">.3</span>,</span>
<span>  c_vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">df_cousin</span><span class="op">$</span><span class="va">cnuRel</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  r_vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">df_cousin</span><span class="op">$</span><span class="va">addRel</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>    pid <span class="op">=</span> <span class="va">id</span>,</span>
<span>    <span class="va">r</span>,</span>
<span>    weight_s1 <span class="op">=</span> <span class="va">y1_1</span>,</span>
<span>    weight_s2 <span class="op">=</span> <span class="va">y1_2</span>,</span>
<span>    height_s1 <span class="op">=</span> <span class="va">y2_1</span>,</span>
<span>    height_s2 <span class="op">=</span> <span class="va">y2_2</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    age_s1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, mean <span class="op">=</span> <span class="fl">30</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    age_s2 <span class="op">=</span> <span class="va">age_s1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">df_synthetic</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">pid</th>
<th align="right">r</th>
<th align="right">weight_s1</th>
<th align="right">weight_s2</th>
<th align="right">height_s1</th>
<th align="right">height_s2</th>
<th align="right">age_s1</th>
<th align="right">age_s2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.12</td>
<td align="right">2.09</td>
<td align="right">-1.30</td>
<td align="right">4.54</td>
<td align="right">-0.66</td>
<td align="right">31</td>
<td align="right">30</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.12</td>
<td align="right">1.21</td>
<td align="right">0.40</td>
<td align="right">1.20</td>
<td align="right">0.26</td>
<td align="right">32</td>
<td align="right">28</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.12</td>
<td align="right">1.03</td>
<td align="right">2.53</td>
<td align="right">2.76</td>
<td align="right">0.58</td>
<td align="right">29</td>
<td align="right">27</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">0.12</td>
<td align="right">1.46</td>
<td align="right">4.92</td>
<td align="right">0.93</td>
<td align="right">-0.67</td>
<td align="right">30</td>
<td align="right">29</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">0.12</td>
<td align="right">2.69</td>
<td align="right">2.78</td>
<td align="right">0.95</td>
<td align="right">-0.54</td>
<td align="right">23</td>
<td align="right">18</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="ordering-and-derived-variables">Ordering and Derived Variables<a class="anchor" aria-label="anchor" href="#ordering-and-derived-variables"></a>
</h2>
<p>Now that we have our data in wide format, we can proceed to order the
pairs and create the derived variables needed for discordant-kinship
regression. The key steps are:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Ordering the pairs</strong>: We need to ensure that within
each pair, the individual with the higher outcome value is consistently
labeled as <code>_1</code> and the other as <code>_2</code>. This
ordering is to ensure that we can extract meaningful difference
scores.</li>
<li>
<strong>Creating derived variables</strong>: We will create
<code>*_mean</code> and <code>*_diff*</code> variables for both the
outcome and predictor variables. The <code>*_mean</code> variable
represents the average of the two individuals’ values, while the
<code>*_diff</code> variable represents the difference between the two
individuals’ values (i.e., <code>_1 - _2</code>).</li>
</ol>
<p>These steps can be accomplished using the <code><a href="../reference/discord_data.html">discord_data()</a></code>
function from the {discord} package. This function takes care of
ordering the pairs and creating the derived variables, ensuring that the
data is ready for analysis. When using <code><a href="../reference/discord_data.html">discord_data()</a></code>, you
will need to specify the outcome variable, predictor variables, and the
identifiers for the two members of each pair.</p>
<p>Below we default to the long path for reproducibility. Replace with
your chosen source as needed.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># CHOOSE ONE based on your path</span></span>
<span><span class="co"># source_wide &lt;- df_wide</span></span>
<span><span class="co"># source_wide &lt;- df_long2wide</span></span>
<span><span class="va">source_wide</span> <span class="op">&lt;-</span> <span class="va">df_synthetic</span> <span class="co"># if you followed the pedigree path</span></span></code></pre></div>
<p>Now call <code><a href="../reference/discord_data.html">discord_data()</a></code> specifying the outcome and
predictor present for both siblings. Here we use <code>Y</code> as the
outcome and <code>X</code> as the predictor, with your <code>_S1</code>
/ <code>_S2</code> suffix convention.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_discord_weight</span> <span class="op">&lt;-</span> <span class="fu">discord</span><span class="fu">::</span><span class="fu"><a href="../reference/discord_data.html">discord_data</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">source_wide</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"weight"</span>,</span>
<span>  predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"height"</span>, <span class="st">"age"</span><span class="op">)</span>,</span>
<span>  demographics <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  pair_identifiers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"_s1"</span>, <span class="st">"_s2"</span><span class="op">)</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"pid"</span> <span class="co"># or "famID" if you followed the pedigree path</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_discord_weight</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span>, caption <span class="op">=</span> <span class="st">"Transformed data ready for discordant-kinship regression"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Transformed data ready for discordant-kinship
regression</caption>
<colgroup>
<col width="2%">
<col width="7%">
<col width="7%">
<col width="10%">
<col width="10%">
<col width="7%">
<col width="7%">
<col width="10%">
<col width="10%">
<col width="5%">
<col width="5%">
<col width="7%">
<col width="7%">
</colgroup>
<thead><tr class="header">
<th align="right">id</th>
<th align="right">weight_1</th>
<th align="right">weight_2</th>
<th align="right">weight_diff</th>
<th align="right">weight_mean</th>
<th align="right">height_1</th>
<th align="right">height_2</th>
<th align="right">height_diff</th>
<th align="right">height_mean</th>
<th align="right">age_1</th>
<th align="right">age_2</th>
<th align="right">age_diff</th>
<th align="right">age_mean</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">2.09</td>
<td align="right">-1.30</td>
<td align="right">3.39</td>
<td align="right">0.39</td>
<td align="right">4.54</td>
<td align="right">-0.66</td>
<td align="right">5.20</td>
<td align="right">1.94</td>
<td align="right">31</td>
<td align="right">30</td>
<td align="right">1</td>
<td align="right">30.5</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1.21</td>
<td align="right">0.40</td>
<td align="right">0.81</td>
<td align="right">0.80</td>
<td align="right">1.20</td>
<td align="right">0.26</td>
<td align="right">0.94</td>
<td align="right">0.73</td>
<td align="right">32</td>
<td align="right">28</td>
<td align="right">4</td>
<td align="right">30.0</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">2.53</td>
<td align="right">1.03</td>
<td align="right">1.51</td>
<td align="right">1.78</td>
<td align="right">0.58</td>
<td align="right">2.76</td>
<td align="right">-2.18</td>
<td align="right">1.67</td>
<td align="right">27</td>
<td align="right">29</td>
<td align="right">-2</td>
<td align="right">28.0</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">4.92</td>
<td align="right">1.46</td>
<td align="right">3.46</td>
<td align="right">3.19</td>
<td align="right">-0.67</td>
<td align="right">0.93</td>
<td align="right">-1.60</td>
<td align="right">0.13</td>
<td align="right">29</td>
<td align="right">30</td>
<td align="right">-1</td>
<td align="right">29.5</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">2.78</td>
<td align="right">2.69</td>
<td align="right">0.09</td>
<td align="right">2.74</td>
<td align="right">-0.54</td>
<td align="right">0.95</td>
<td align="right">-1.49</td>
<td align="right">0.21</td>
<td align="right">18</td>
<td align="right">23</td>
<td align="right">-5</td>
<td align="right">20.5</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="understanding-the-transformation">Understanding the Transformation<a class="anchor" aria-label="anchor" href="#understanding-the-transformation"></a>
</h3>
<p>Let’s examine what <code><a href="../reference/discord_data.html">discord_data()</a></code> did to our
variables:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_discord_weight</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>    <span class="va">id</span>,</span>
<span>    <span class="va">weight_1</span>, <span class="va">weight_2</span>, <span class="va">weight_mean</span>, <span class="va">weight_diff</span>,</span>
<span>    <span class="va">height_1</span>, <span class="va">height_2</span>, <span class="va">height_mean</span>, <span class="va">height_diff</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="3%">
<col width="10%">
<col width="10%">
<col width="13%">
<col width="13%">
<col width="10%">
<col width="10%">
<col width="13%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="right">id</th>
<th align="right">weight_1</th>
<th align="right">weight_2</th>
<th align="right">weight_mean</th>
<th align="right">weight_diff</th>
<th align="right">height_1</th>
<th align="right">height_2</th>
<th align="right">height_mean</th>
<th align="right">height_diff</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">2.09</td>
<td align="right">-1.30</td>
<td align="right">0.39</td>
<td align="right">3.39</td>
<td align="right">4.54</td>
<td align="right">-0.66</td>
<td align="right">1.94</td>
<td align="right">5.20</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1.21</td>
<td align="right">0.40</td>
<td align="right">0.80</td>
<td align="right">0.81</td>
<td align="right">1.20</td>
<td align="right">0.26</td>
<td align="right">0.73</td>
<td align="right">0.94</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">2.53</td>
<td align="right">1.03</td>
<td align="right">1.78</td>
<td align="right">1.51</td>
<td align="right">0.58</td>
<td align="right">2.76</td>
<td align="right">1.67</td>
<td align="right">-2.18</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">4.92</td>
<td align="right">1.46</td>
<td align="right">3.19</td>
<td align="right">3.46</td>
<td align="right">-0.67</td>
<td align="right">0.93</td>
<td align="right">0.13</td>
<td align="right">-1.60</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">2.78</td>
<td align="right">2.69</td>
<td align="right">2.74</td>
<td align="right">0.09</td>
<td align="right">-0.54</td>
<td align="right">0.95</td>
<td align="right">0.21</td>
<td align="right">-1.49</td>
</tr>
</tbody>
</table>
<p>Notice several important patterns in this output. First,
<code>weight_1</code> is always greater than or equal to
<code>weight_2</code> because <code><a href="../reference/discord_data.html">discord_data()</a></code> ordered
siblings by the outcome variable. The sibling with higher weight becomes
<code>_1</code> and the sibling with lower weight becomes
<code>_2</code>. This ordering ensures that <code>weight_diff</code>
(calculated as <code>weight_1 - weight_2</code>) is always
non-negative.</p>
<p>Second, the mean scores represent each pair’s average. For example,
<code>weight_mean</code> equals the average of <code>weight_1</code> and
<code>weight_2</code>. These means capture between-family variation -
how pairs differ from each other in average weight.</p>
<p>Third, the predictor differences can be positive or negative. Even
though weight differences are always positive (by construction), height
differences vary. The taller sibling might be the heavier one, or the
shorter sibling might be heavier. This variation is what we’ll test in
our regression.</p>
<p>This structure lets us ask a key question: within sibling pairs, does
the sibling with more of the predictor also have more of the outcome? If
the taller sibling is systematically heavier even after controlling for
family background, that suggests height may causally influence weight.
If not, the association likely reflects familial confounding.</p>
</div>
</div>
<div class="section level2">
<h2 id="analyzing-the-data">Analyzing the Data<a class="anchor" aria-label="anchor" href="#analyzing-the-data"></a>
</h2>
<p>With our data prepared, we can now perform both standard OLS
regression and discordant-kinship regression to compare results.</p>
<div class="section level3">
<h3 id="standard-ols-regression">Standard OLS Regression<a class="anchor" aria-label="anchor" href="#standard-ols-regression"></a>
</h3>
<p>First, let’s run a standard OLS regression using the original
wide-format data. This will serve as a baseline for comparison with the
family-based analyses.</p>
<p>For our baseline analysis, we select one sibling from each pair. In
the original dataset, s1 was defined as the older sibling, so we can
simply choose the sibling labeled <code>_s1</code>. But, another way to
select the oldest sibling is to use the <code><a href="../reference/discord_data.html">discord_data()</a></code>
function with the <code>outcome</code> argument set to the age variable.
This will ensure that <code>_1</code> is always the oldest sibling
within the pair. In the case of ties, one sibling is randomly assigned
as <code>_1</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_for_ols</span> <span class="op">&lt;-</span> <span class="va">df_synthetic</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>    id <span class="op">=</span> <span class="va">pid</span>,</span>
<span>    weight <span class="op">=</span> <span class="va">weight_s1</span>,</span>
<span>    height <span class="op">=</span> <span class="va">height_s1</span>,</span>
<span>    age <span class="op">=</span> <span class="va">age_s1</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">df_discord_age</span> <span class="op">&lt;-</span> <span class="fu">discord</span><span class="fu">::</span><span class="fu"><a href="../reference/discord_data.html">discord_data</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">source_wide</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"age"</span>,</span>
<span>  predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"height"</span>, <span class="st">"weight"</span><span class="op">)</span>,</span>
<span>  demographics <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  pair_identifiers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"_s1"</span>, <span class="st">"_s2"</span><span class="op">)</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"pid"</span> <span class="co"># or "famID" if you followed the pedigree path</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_discord_age</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>    <span class="va">id</span>, <span class="va">age_1</span>, <span class="va">age_2</span>,</span>
<span>    <span class="va">age_mean</span>, <span class="va">age_diff</span>, <span class="va">weight_1</span>, <span class="va">height_1</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"One sibling per pair for OLS regression, selecting by age"</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>One sibling per pair for OLS regression, selecting by
age</caption>
<thead><tr class="header">
<th align="right">id</th>
<th align="right">age_1</th>
<th align="right">age_2</th>
<th align="right">age_mean</th>
<th align="right">age_diff</th>
<th align="right">weight_1</th>
<th align="right">height_1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">31</td>
<td align="right">30</td>
<td align="right">30.5</td>
<td align="right">1</td>
<td align="right">2.09</td>
<td align="right">4.54</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">32</td>
<td align="right">28</td>
<td align="right">30.0</td>
<td align="right">4</td>
<td align="right">1.21</td>
<td align="right">1.20</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">29</td>
<td align="right">27</td>
<td align="right">28.0</td>
<td align="right">2</td>
<td align="right">1.03</td>
<td align="right">2.76</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">30</td>
<td align="right">29</td>
<td align="right">29.5</td>
<td align="right">1</td>
<td align="right">1.46</td>
<td align="right">0.93</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">23</td>
<td align="right">18</td>
<td align="right">20.5</td>
<td align="right">5</td>
<td align="right">2.69</td>
<td align="right">0.95</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">df_for_ols</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">age</span>, <span class="va">weight</span>, <span class="va">height</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"One sibling per pair for OLS regression using original wide data"</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>One sibling per pair for OLS regression using original wide
data</caption>
<thead><tr class="header">
<th align="right">id</th>
<th align="right">age</th>
<th align="right">weight</th>
<th align="right">height</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">31</td>
<td align="right">2.09</td>
<td align="right">4.54</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">32</td>
<td align="right">1.21</td>
<td align="right">1.20</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">29</td>
<td align="right">1.03</td>
<td align="right">2.76</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">30</td>
<td align="right">1.46</td>
<td align="right">0.93</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">23</td>
<td align="right">2.69</td>
<td align="right">0.95</td>
</tr>
</tbody>
</table>
<p>As you can see, <code>df_for_ols</code> and
<code>df_discord_age</code> both resulted in the same individuals being
selected for analysis. The <code>df_discord_age</code> dataset was
created by ordering siblings based on age, ensuring that <code>_1</code>
is always the older sibling. The <code>df_for_ols</code> dataset
directly selects the older sibling from the original wide data.</p>
<p>By selecting one sibling per pair, we’re analyzing the same number of
observations as we have kinship pairs. This represents the standard
individual-level approach used in most research:</p>
<p><span class="math display">$$ Y = \\beta_0 + \\beta_1 X1 + \\beta_2
X2 + \\epsilon $$</span></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ols_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">height</span> <span class="op">+</span> <span class="va">age</span>, data <span class="op">=</span> <span class="va">df_for_ols</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">stargazer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stargazer/man/stargazer.html" class="external-link">stargazer</a></span><span class="op">(</span><span class="va">ols_model</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"html"</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">3</span>, single.row <span class="op">=</span> <span class="cn">TRUE</span>, title <span class="op">=</span> <span class="st">"Standard OLS Regression Results"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table style="text-align:center" class="table">
<caption>
<strong>Standard OLS Regression Results</strong>
</caption>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
weight
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
height
</td>
<td>
0.287<sup>***</sup> (0.078)
</td>
</tr>
<tr>
<td style="text-align:left">
age
</td>
<td>
-0.073<sup>**</sup> (0.029)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
2.788<sup>***</sup> (0.871)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
141
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.125
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.112
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
1.573 (df = 138)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
9.857<sup>***</sup> (df = 2; 138)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05;
<sup></sup>p&lt;0.01
</td>
</tr>
</table>
<p>This standard regression shows associations between our variables
while controlling only for measured covariates.</p>
</div>
<div class="section level3">
<h3 id="discordant-between-family-regression">Discordant Between-Family Regression<a class="anchor" aria-label="anchor" href="#discordant-between-family-regression"></a>
</h3>
<p>Next, we run a between-family regression using the discordant data.
This model regresses the outcome mean on predictor means, capturing
between-family variation:</p>
<p><span class="math display">$$ Y_{mean} = \\beta_0 + \\beta_1
X1_{mean} + \\beta_2 X2_{mean} + \\epsilon $$</span></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">between_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">weight_mean</span> <span class="op">~</span> <span class="va">height_mean</span> <span class="op">+</span> <span class="va">age_mean</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df_discord_weight</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">stargazer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stargazer/man/stargazer.html" class="external-link">stargazer</a></span><span class="op">(</span><span class="va">between_model</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"html"</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">3</span>, single.row <span class="op">=</span> <span class="cn">TRUE</span>, title <span class="op">=</span> <span class="st">"Between-Family Regression Results"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table style="text-align:center" class="table">
<caption>
<strong>Between-Family Regression Results</strong>
</caption>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
weight_mean
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
height_mean
</td>
<td>
0.199<sup>**</sup> (0.077)
</td>
</tr>
<tr>
<td style="text-align:left">
age_mean
</td>
<td>
-0.044<sup>*</sup> (0.023)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
2.064<sup>***</sup> (0.666)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
141
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.067
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.054
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
1.284 (df = 138)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
4.970<sup>***</sup> (df = 2; 138)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05;
<sup></sup>p&lt;0.01
</td>
</tr>
</table>
<p>This between-family regression captures how differences in average
height and age across families relate to average weight. However, it
does not account for within-family differences, which is where
discordant-kinship regression comes in.</p>
<p>It is important to note that the between-family regression results
are not directly comparable to the standard OLS regression results. The
between-family model uses mean scores, which represent family-level
averages, while the OLS model uses individual-level data. Therefore, the
coefficients from these two models may differ in magnitude and
interpretation. But, they both provide useful information about the
relationships among the variables.</p>
</div>
<div class="section level3">
<h3 id="discordant-kinship-regression">Discordant-Kinship Regression<a class="anchor" aria-label="anchor" href="#discordant-kinship-regression"></a>
</h3>
<p>Now we return to our prepared data to run discordant-kinship
regression. We can specify the models manually or use the
<code><a href="../reference/discord_regression.html">discord_regression()</a></code> convenience function. Both approaches
produce identical results.</p>
<p>The discordant model regresses the outcome difference on outcome
mean, predictor means, and predictor differences:</p>
<p><span class="math display">$$ Y_{diff} = \\beta_0 + \\beta_1 Y_{mean}
+ \\beta_2 X1_{mean} + \\beta_3 X1_{diff} + \\beta_4 X2_{mean} +
\\beta_5 X2_{diff} + \\epsilon $$</span></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">discord_model_manual</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">weight_diff</span> <span class="op">~</span> <span class="va">weight_mean</span> <span class="op">+</span> <span class="va">height_mean</span> <span class="op">+</span> <span class="va">height_diff</span> <span class="op">+</span> <span class="va">age_mean</span> <span class="op">+</span> <span class="va">age_diff</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df_discord_weight</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">discord_model_manual</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span>, caption <span class="op">=</span> <span class="st">"Discordant Regression (Manual)"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Discordant Regression (Manual)</caption>
<colgroup>
<col width="17%">
<col width="13%">
<col width="14%">
<col width="14%">
<col width="11%">
<col width="13%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">conf.low</th>
<th align="right">conf.high</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.500</td>
<td align="right">0.528</td>
<td align="right">0.948</td>
<td align="right">0.345</td>
<td align="right">-0.544</td>
<td align="right">1.544</td>
</tr>
<tr class="even">
<td align="left">weight_mean</td>
<td align="right">-0.043</td>
<td align="right">0.065</td>
<td align="right">-0.660</td>
<td align="right">0.511</td>
<td align="right">-0.171</td>
<td align="right">0.086</td>
</tr>
<tr class="odd">
<td align="left">height_mean</td>
<td align="right">0.041</td>
<td align="right">0.060</td>
<td align="right">0.680</td>
<td align="right">0.498</td>
<td align="right">-0.078</td>
<td align="right">0.159</td>
</tr>
<tr class="even">
<td align="left">height_diff</td>
<td align="right">0.141</td>
<td align="right">0.043</td>
<td align="right">3.254</td>
<td align="right">0.001</td>
<td align="right">0.055</td>
<td align="right">0.226</td>
</tr>
<tr class="odd">
<td align="left">age_mean</td>
<td align="right">0.031</td>
<td align="right">0.018</td>
<td align="right">1.742</td>
<td align="right">0.084</td>
<td align="right">-0.004</td>
<td align="right">0.066</td>
</tr>
<tr class="even">
<td align="left">age_diff</td>
<td align="right">-0.026</td>
<td align="right">0.024</td>
<td align="right">-1.092</td>
<td align="right">0.277</td>
<td align="right">-0.074</td>
<td align="right">0.021</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">stargazer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stargazer/man/stargazer.html" class="external-link">stargazer</a></span><span class="op">(</span><span class="va">between_model</span>, <span class="va">discord_model_manual</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"html"</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">3</span>, single.row <span class="op">=</span> <span class="cn">TRUE</span>, title <span class="op">=</span> <span class="st">"Between-Family and Discordant Regression Results"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table style="text-align:center" class="table">
<caption>
<strong>Between-Family and Discordant Regression Results</strong>
</caption>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
weight_mean
</td>
<td>
weight_diff
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
weight_mean
</td>
<td>
</td>
<td>
-0.043 (0.065)
</td>
</tr>
<tr>
<td style="text-align:left">
height_mean
</td>
<td>
0.199<sup>**</sup> (0.077)
</td>
<td>
0.041 (0.060)
</td>
</tr>
<tr>
<td style="text-align:left">
height_diff
</td>
<td>
</td>
<td>
0.141<sup>***</sup> (0.043)
</td>
</tr>
<tr>
<td style="text-align:left">
age_mean
</td>
<td>
-0.044<sup>*</sup> (0.023)
</td>
<td>
0.031<sup>*</sup> (0.018)
</td>
</tr>
<tr>
<td style="text-align:left">
age_diff
</td>
<td>
</td>
<td>
-0.026 (0.024)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
2.064<sup>***</sup> (0.666)
</td>
<td>
0.500 (0.528)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
141
</td>
<td>
141
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.067
</td>
<td>
0.102
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.054
</td>
<td>
0.069
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
1.284 (df = 138)
</td>
<td>
0.978 (df = 135)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
4.970<sup>***</sup> (df = 2; 138)
</td>
<td>
3.060<sup>**</sup> (df = 5; 135)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="2" style="text-align:right">
<sup><em></em></sup>p&lt;0.1; <sup><strong></strong></sup>p&lt;0.05;
<sup></sup>p&lt;0.01
</td>
</tr>
</table>
<p>Note that we are using the df_discord_weight dataset created earlier
with <code><a href="../reference/discord_data.html">discord_data()</a></code>. This dataset is ordered such that
within a pair, the sibling with the higher weight is always
<code>_1</code>. This ordering ensures that <code>weight_diff</code> is
always non-negative, which is a key feature of discordant-kinship
regression.</p>
<div class="section level4">
<h4 id="using-the-helper-function">Using the Helper Function<a class="anchor" aria-label="anchor" href="#using-the-helper-function"></a>
</h4>
<p>Alternatively, we can use the <code><a href="../reference/discord_regression.html">discord_regression()</a></code>
function, which simplifies the process:</p>
<p>By default, <code><a href="../reference/discord_regression.html">discord_regression()</a></code> orders siblings by the
outcome variable, creates the necessary derived variables, and fits the
discordant regression model in one step. This function also allows for
easy inclusion of demographic covariates if needed. See the function
documentation for more details on these options, as well as a vignette
focused on demographic controls.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">discord_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/discord_regression.html">discord_regression</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">source_wide</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"weight"</span>,</span>
<span>  predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"height"</span>, <span class="st">"age"</span><span class="op">)</span>,</span>
<span>  demographics <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  sex <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  race <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pair_identifiers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"_s1"</span>, <span class="st">"_s2"</span><span class="op">)</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"pid"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">discord_model</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span>, caption <span class="op">=</span> <span class="st">"Discordant Regression Results"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Discordant Regression Results</caption>
<colgroup>
<col width="17%">
<col width="13%">
<col width="14%">
<col width="14%">
<col width="11%">
<col width="13%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">conf.low</th>
<th align="right">conf.high</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.500</td>
<td align="right">0.528</td>
<td align="right">0.948</td>
<td align="right">0.345</td>
<td align="right">-0.544</td>
<td align="right">1.544</td>
</tr>
<tr class="even">
<td align="left">weight_mean</td>
<td align="right">-0.043</td>
<td align="right">0.065</td>
<td align="right">-0.660</td>
<td align="right">0.511</td>
<td align="right">-0.171</td>
<td align="right">0.086</td>
</tr>
<tr class="odd">
<td align="left">height_diff</td>
<td align="right">0.141</td>
<td align="right">0.043</td>
<td align="right">3.254</td>
<td align="right">0.001</td>
<td align="right">0.055</td>
<td align="right">0.226</td>
</tr>
<tr class="even">
<td align="left">age_diff</td>
<td align="right">-0.026</td>
<td align="right">0.024</td>
<td align="right">-1.092</td>
<td align="right">0.277</td>
<td align="right">-0.074</td>
<td align="right">0.021</td>
</tr>
<tr class="odd">
<td align="left">height_mean</td>
<td align="right">0.041</td>
<td align="right">0.060</td>
<td align="right">0.680</td>
<td align="right">0.498</td>
<td align="right">-0.078</td>
<td align="right">0.159</td>
</tr>
<tr class="even">
<td align="left">age_mean</td>
<td align="right">0.031</td>
<td align="right">0.018</td>
<td align="right">1.742</td>
<td align="right">0.084</td>
<td align="right">-0.004</td>
<td align="right">0.066</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="va">discord_model</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">r.squared</span>, <span class="va">adj.r.squared</span>, <span class="va">sigma</span>, <span class="va">p.value</span>, <span class="va">nobs</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">r.squared</th>
<th align="right">adj.r.squared</th>
<th align="right">sigma</th>
<th align="right">p.value</th>
<th align="right">nobs</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">0.102</td>
<td align="right">0.069</td>
<td align="right">0.978</td>
<td align="right">0.012</td>
<td align="right">141</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">stargazer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stargazer/man/stargazer.html" class="external-link">stargazer</a></span><span class="op">(</span><span class="va">discord_model</span>,</span>
<span>  <span class="va">discord_model_manual</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"html"</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">3</span>, single.row <span class="op">=</span> <span class="cn">TRUE</span>, title <span class="op">=</span> <span class="st">"Discordant Regression Results Comparison"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>% Error: Unrecognized object type.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sessioninfo</span><span class="fu">::</span><span class="fu"><a href="https://sessioninfo.r-lib.org/reference/session_info.html" class="external-link">session_info</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">─ Session info ───────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555; font-style: italic;">setting </span> <span style="color: #555555; font-style: italic;">value</span></span></span>
<span><span class="co">#&gt;  version  R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">#&gt;  os       Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">#&gt;  system   x86_64, linux-gnu</span></span>
<span><span class="co">#&gt;  ui       X11</span></span>
<span><span class="co">#&gt;  language en</span></span>
<span><span class="co">#&gt;  collate  C.UTF-8</span></span>
<span><span class="co">#&gt;  ctype    C.UTF-8</span></span>
<span><span class="co">#&gt;  tz       UTC</span></span>
<span><span class="co">#&gt;  date     2025-10-18</span></span>
<span><span class="co">#&gt;  pandoc   3.1.11 @ /opt/hostedtoolcache/pandoc/3.1.11/x64/ (via rmarkdown)</span></span>
<span><span class="co">#&gt;  quarto   NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">─ Packages ───────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555; font-style: italic;">package     </span> <span style="color: #555555; font-style: italic;">*</span> <span style="color: #555555; font-style: italic;">version</span> <span style="color: #555555; font-style: italic;">date (UTC)</span> <span style="color: #555555; font-style: italic;">lib</span> <span style="color: #555555; font-style: italic;">source</span></span></span>
<span><span class="co">#&gt;  backports      1.5.0   <span style="color: #555555;">2024-05-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  BGmisc       * 1.5.0   <span style="color: #555555;">2025-07-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  broom        * 1.0.10  <span style="color: #555555;">2025-09-13</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  bslib          0.9.0   <span style="color: #555555;">2025-01-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  cachem         1.1.0   <span style="color: #555555;">2024-05-16</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  cli            3.6.5   <span style="color: #555555;">2025-04-23</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  data.table     1.17.8  <span style="color: #555555;">2025-07-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  desc           1.4.3   <span style="color: #555555;">2023-12-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  digest         0.6.37  <span style="color: #555555;">2024-08-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  discord      * 1.3     <span style="color: #555555;">2025-10-18</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">local</span></span></span>
<span><span class="co">#&gt;  dplyr        * 1.1.4   <span style="color: #555555;">2023-11-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  evaluate       1.0.5   <span style="color: #555555;">2025-08-27</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  farver         2.1.2   <span style="color: #555555;">2024-05-13</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  fastmap        1.2.0   <span style="color: #555555;">2024-05-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  fs             1.6.6   <span style="color: #555555;">2025-04-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  generics       0.1.4   <span style="color: #555555;">2025-05-09</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  ggpedigree   * 0.9.0   <span style="color: #555555;">2025-09-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  ggplot2      * 4.0.0   <span style="color: #555555;">2025-09-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  glue           1.8.0   <span style="color: #555555;">2024-09-30</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  gtable         0.3.6   <span style="color: #555555;">2024-10-25</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  htmltools      0.5.8.1 <span style="color: #555555;">2024-04-04</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  htmlwidgets    1.6.4   <span style="color: #555555;">2023-12-06</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  janitor      * 2.2.1   <span style="color: #555555;">2024-12-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  jquerylib      0.1.4   <span style="color: #555555;">2021-04-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  jsonlite       2.0.0   <span style="color: #555555;">2025-03-27</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  kinship2       1.9.6.2 <span style="color: #555555;">2025-09-04</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  knitr          1.50    <span style="color: #555555;">2025-03-16</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  labeling       0.4.3   <span style="color: #555555;">2023-08-29</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  lattice        0.22-7  <span style="color: #555555;">2025-04-02</span> <span style="color: #555555;">[3]</span> <span style="color: #555555;">CRAN (R 4.5.1)</span></span></span>
<span><span class="co">#&gt;  lifecycle      1.0.4   <span style="color: #555555;">2023-11-07</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  lubridate      1.9.4   <span style="color: #555555;">2024-12-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  magrittr     * 2.0.4   <span style="color: #555555;">2025-09-12</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  Matrix         1.7-3   <span style="color: #555555;">2025-03-11</span> <span style="color: #555555;">[3]</span> <span style="color: #555555;">CRAN (R 4.5.1)</span></span></span>
<span><span class="co">#&gt;  NlsyLinks    * 2.2.3   <span style="color: #555555;">2025-08-31</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  pillar         1.11.1  <span style="color: #555555;">2025-09-17</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  pkgconfig      2.0.3   <span style="color: #555555;">2019-09-22</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  pkgdown        2.1.3   <span style="color: #555555;">2025-05-25</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">any (@2.1.3)</span></span></span>
<span><span class="co">#&gt;  purrr          1.1.0   <span style="color: #555555;">2025-07-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  quadprog       1.5-8   <span style="color: #555555;">2019-11-20</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  R6             2.6.1   <span style="color: #555555;">2025-02-15</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  ragg           1.5.0   <span style="color: #555555;">2025-09-02</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  RColorBrewer   1.1-3   <span style="color: #555555;">2022-04-03</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  rlang          1.1.6   <span style="color: #555555;">2025-04-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  rmarkdown      2.30    <span style="color: #555555;">2025-09-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  S7             0.2.0   <span style="color: #555555;">2024-11-07</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  sass           0.4.10  <span style="color: #555555;">2025-04-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  scales         1.4.0   <span style="color: #555555;">2025-04-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  sessioninfo    1.2.3   <span style="color: #555555;">2025-02-05</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  snakecase      0.11.1  <span style="color: #555555;">2023-08-27</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  stargazer      5.2.3   <span style="color: #555555;">2022-03-04</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  stringi        1.8.7   <span style="color: #555555;">2025-03-27</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  stringr        1.5.2   <span style="color: #555555;">2025-09-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  systemfonts    1.3.1   <span style="color: #555555;">2025-10-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  textshaping    1.0.4   <span style="color: #555555;">2025-10-10</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  tibble         3.3.0   <span style="color: #555555;">2025-06-08</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  tidyr        * 1.3.1   <span style="color: #555555;">2024-01-24</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  tidyselect     1.2.1   <span style="color: #555555;">2024-03-11</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  timechange     0.3.0   <span style="color: #555555;">2024-01-18</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  vctrs          0.6.5   <span style="color: #555555;">2023-12-01</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  withr          3.0.2   <span style="color: #555555;">2024-10-28</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  xfun           0.53    <span style="color: #555555;">2025-08-19</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt;  yaml           2.3.10  <span style="color: #555555;">2024-07-26</span> <span style="color: #555555;">[1]</span> <span style="color: #BB00BB; font-weight: bold;">RSPM</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [1] /home/runner/work/_temp/Library</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [2] /opt/R/4.5.1/lib/R/site-library</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;"> [3] /opt/R/4.5.1/lib/R/library</span></span></span>
<span><span class="co">#&gt;  <span style="color: #BBBBBB; background-color: #BB0000;">*</span> ── Packages attached to the search path.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB; font-weight: bold;">──────────────────────────────────────────────────────────────────────────────</span></span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by S. Mason Garrison, Jonathan Trattner, Yoo Ri Hwang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
