<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>No Database? No Problem: Using discord with Simple Family Structures • discord</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="No Database? No Problem: Using discord with Simple Family Structures">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">discord</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/categorical_predictors.html">Demonstrating Categorical Predictors in Discordant-Kinship Regressions</a></li>
    <li><a class="dropdown-item" href="../articles/links.html">No Database? No Problem: Using discord with Simple Family Structures</a></li>
    <li><a class="dropdown-item" href="../articles/plots.html">Plots</a></li>
    <li><a class="dropdown-item" href="../articles/Power.html">Power</a></li>
    <li><a class="dropdown-item" href="../articles/regression.html">Regression demonstration</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-Computing-Lab/discord/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>No Database? No Problem: Using discord with Simple Family Structures</h1>
                        <h4 data-toc-skip class="author">Mason
Garrison</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/R-Computing-Lab/discord/blob/main/vignettes/links.Rmd" class="external-link"><code>vignettes/links.Rmd</code></a></small>
      <div class="d-none name"><code>links.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The {discord} package was originally developed for use with the
National Longitudinal Survey of Youth (NLSY), but its functionality
extends far beyond that. When paired with its sister package {BGmisc},
discord can be applied to any dataset containing basic family structure
information, allowing researchers to explore genetic and environmental
influences without requiring pre-constructed kinship links.</p>
<p>This vignette demonstrates how to:</p>
<ul>
<li>Construct kinship links from simple family data (e.g., individual
ID, mother ID, father ID).</li>
<li>Simulate phenotyipic data based on known genetic and environmental
structures.</li>
<li>Fit a discordant-kinship regression model using the simulated
data.</li>
</ul>
<p>We use tools from {BGmisc} and a toy dataset to illustrate the
workflow.</p>
</div>
<div class="section level2">
<h2 id="loading-packages-and-data">Loading Packages and Data<a class="anchor" aria-label="anchor" href="#loading-packages-and-data"></a>
</h2>
<p>We begin by loading the required packages and a built-in dataset from
{BGmisc}.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/R-Computing-Lab/BGmisc/" class="external-link">BGmisc</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/R-Computing-Lab/discord" class="external-link">discord</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">stargazer</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">potter</span><span class="op">)</span></span></code></pre></div>
<p>We rename the family ID column to avoid naming conflicts and generate
a pedigree-encoded data frame.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_potter</span> <span class="op">&lt;-</span> <span class="va">potter</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_potter</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_potter</span><span class="op">)</span> <span class="op">==</span> <span class="st">"famID"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"oldfam"</span></span>
<span></span>
<span><span class="va">df_potter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-computing-lab.github.io/BGmisc/reference/ped2fam.html" class="external-link">ped2fam</a></span><span class="op">(</span><span class="va">df_potter</span>,</span>
<span>  famID <span class="op">=</span> <span class="st">"famID"</span>,</span>
<span>  personID <span class="op">=</span> <span class="st">"personID"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We also verify and repair sex coding to ensure compatibility with
downstream pedigree operations.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_potter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-computing-lab.github.io/BGmisc/reference/checkSex.html" class="external-link">checkSex</a></span><span class="op">(</span><span class="va">df_potter</span>,</span>
<span>  code_male <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  code_female <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>, repair <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">BGmisc</span><span class="fu">::</span><span class="fu"><a href="https://r-computing-lab.github.io/BGmisc/reference/plotPedigree.html" class="external-link">plotPedigree</a></span><span class="op">(</span><span class="va">df_potter</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="links_files/figure-html/unnamed-chunk-5-1.png" alt="Pedigree plot of the Potter dataset" width="384"><p class="caption">
Pedigree plot of the Potter dataset
</p>
</div>
<pre><code><span><span class="co">#&gt; named list()</span></span></code></pre>
<p>The pedigree plot provides a visual representation of the kinship
structure in the dataset. Each node represents an individual, and the
edges indicate familial relationships.</p>
</div>
<div class="section level2">
<h2 id="constructing-kinship-links">Constructing Kinship Links<a class="anchor" aria-label="anchor" href="#constructing-kinship-links"></a>
</h2>
<p>To extract the necessary kinship information, we need to compute two
matrices: the additive genetic relatedness matrix and the shared
environment matrix. These matrices are derived from the pedigree data
and are essential for understanding the genetic and environmental
relationships among individuals. Using {BGmisc}, we compute:</p>
<ul>
<li><p>The additive genetic relatedness matrix (add).</p></li>
<li><p>The shared environment matrix (cn), indicating whether kin were
raised together (1) or apart (0).</p></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">add</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-computing-lab.github.io/BGmisc/reference/ped2add.html" class="external-link">ped2add</a></span><span class="op">(</span><span class="va">df_potter</span><span class="op">)</span></span>
<span><span class="va">cn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-computing-lab.github.io/BGmisc/reference/ped2cn.html" class="external-link">ped2cn</a></span><span class="op">(</span><span class="va">df_potter</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="https://r-computing-lab.github.io/BGmisc/reference/ped2add.html" class="external-link">ped2add()</a></code> function computes the additive genetic
relatedness matrix, which quantifies the genetic similarity between
individuals based on their pedigree information. The
<code><a href="https://r-computing-lab.github.io/BGmisc/reference/ped2cn.html" class="external-link">ped2cn()</a></code> function computes the shared environment matrix,
which indicates whether individuals were raised in the same environment
(1) or different environments (0).</p>
<p>The resulting matrices are symmetric, with diagonal elements
representing self-relatedness (1.0). The off-diagonal elements represent
the relatedness between pairs of individuals, with values ranging from 0
(no relatedness) to 0.5 (full siblings) to 1 (themselves).</p>
<p>We convert the component matrices into a long-form data frame of kin
pairs using <code><a href="https://r-computing-lab.github.io/BGmisc/reference/com2links.html" class="external-link">com2links()</a></code>. Self-pairs and duplicate entries
are removed.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_links</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-computing-lab.github.io/BGmisc/reference/com2links.html" class="external-link">com2links</a></span><span class="op">(</span></span>
<span>  writetodisk <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ad_ped_matrix <span class="op">=</span> <span class="va">add</span>, cn_ped_matrix <span class="op">=</span> <span class="va">cn</span>,</span>
<span>  drop_upper_triangular <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ID1</span> <span class="op">!=</span> <span class="va">ID2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_links</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">ID1</th>
<th align="right">ID2</th>
<th align="right">addRel</th>
<th align="right">cnuRel</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">0.500</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">4</td>
<td align="right">0.500</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">6</td>
<td align="right">0.500</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">6</td>
<td align="right">0.250</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">6</td>
<td align="right">0.500</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">6</td>
<td align="right">0.250</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">7</td>
<td align="right">0.250</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">7</td>
<td align="right">0.500</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">7</td>
<td align="right">0.500</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">7</td>
<td align="right">0.125</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>We then extract two subsets:</p>
<ul>
<li><p>Full siblings: additive relatedness = 0.5 and shared environment
= 1</p></li>
<li><p>Cousins: additive relatedness = 0.125 and shared environment =
0</p></li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_sim</span> <span class="op">&lt;-</span> <span class="va">df_links</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">addRel</span> <span class="op">==</span> <span class="fl">.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># only full siblings %&gt;%</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cnuRel</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># only kin raised in the same home</span></span>
<span></span>
<span><span class="va">df_cousin</span> <span class="op">&lt;-</span> <span class="va">df_links</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">addRel</span> <span class="op">==</span> <span class="fl">.125</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># only cousins %&gt;%</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cnuRel</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># only kin raised in separate homes</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulate-phenotypic-data">Simulate Phenotypic Data<a class="anchor" aria-label="anchor" href="#simulate-phenotypic-data"></a>
</h2>
<p>To simulate phenotypic data, we need to create a data frame that
includes the kinship information and the outcome variables. We will
simulate two outcome variables (y1 and y2) for each cousin pair in the
dataset. The <code><a href="../reference/kinsim.html">kinsim()</a></code> function from {discord} is used to
generate the simulated data based on the specified variance
structure.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">syn_df</span> <span class="op">&lt;-</span> <span class="fu">discord</span><span class="fu">::</span><span class="fu"><a href="../reference/kinsim.html">kinsim</a></span><span class="op">(</span></span>
<span>  mu_all <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  cov_a <span class="op">=</span> <span class="fl">.4</span>,</span>
<span>  cov_e <span class="op">=</span> <span class="fl">.4</span>,</span>
<span>  c_all <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  r_vector <span class="op">=</span> <span class="va">df_cousin</span><span class="op">$</span><span class="va">addRel</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">A1_1</span>, <span class="va">A1_2</span>, <span class="va">A2_1</span>, <span class="va">A2_2</span>,</span>
<span>    <span class="va">C1_1</span>, <span class="va">C1_2</span>, <span class="va">C2_1</span>, <span class="va">C2_2</span>,</span>
<span>    <span class="va">E1_1</span>, <span class="va">E1_2</span>, <span class="va">E2_1</span>, <span class="va">E2_2</span>,</span>
<span>    <span class="va">r</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The simulated data reflect a known variance structure: additive
genetic covariance = .4, genetic correlation = 0.125, no shared
environment, and residual (unique environment) variance = 0.4. Latent
component scores are excluded from the final dataset, but they can be
useful for debugging and understanding the underlying structure of the
data.</p>
<p>We bind the simulated outcome data to the cousin link data to prepare
it for modeling.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_demo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">df_cousin</span>, <span class="va">syn_df</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">data_demo</span><span class="op">)</span></span>
<span><span class="co">#&gt;       ID1             ID2             addRel          cnuRel       y1_1        </span></span>
<span><span class="co">#&gt;  Min.   : 3.00   Min.   :  7.00   Min.   :0.125   Min.   :0   Min.   :-3.6557  </span></span>
<span><span class="co">#&gt;  1st Qu.:21.00   1st Qu.: 26.00   1st Qu.:0.125   1st Qu.:0   1st Qu.:-0.4007  </span></span>
<span><span class="co">#&gt;  Median :23.00   Median : 28.00   Median :0.125   Median :0   Median : 0.3537  </span></span>
<span><span class="co">#&gt;  Mean   :21.62   Mean   : 36.55   Mean   :0.125   Mean   :0   Mean   : 0.6055  </span></span>
<span><span class="co">#&gt;  3rd Qu.:24.00   3rd Qu.: 30.00   3rd Qu.:0.125   3rd Qu.:0   3rd Qu.: 1.6073  </span></span>
<span><span class="co">#&gt;  Max.   :28.00   Max.   :104.00   Max.   :0.125   Max.   :0   Max.   : 4.5506  </span></span>
<span><span class="co">#&gt;       y1_2              y2_1              y2_2               id      </span></span>
<span><span class="co">#&gt;  Min.   :-1.1505   Min.   :-2.2658   Min.   :-2.3618   Min.   : 1.0  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.0983   1st Qu.:-0.4629   1st Qu.: 0.3215   1st Qu.:12.5  </span></span>
<span><span class="co">#&gt;  Median : 1.1069   Median : 0.7087   Median : 1.4460   Median :24.0  </span></span>
<span><span class="co">#&gt;  Mean   : 1.1957   Mean   : 0.9443   Mean   : 1.1523   Mean   :24.0  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 2.1121   3rd Qu.: 2.2073   3rd Qu.: 2.1726   3rd Qu.:35.5  </span></span>
<span><span class="co">#&gt;  Max.   : 5.0089   Max.   : 5.3431   Max.   : 4.2828   Max.   :47.0</span></span></code></pre></div>
<p>The <code>data_demo</code> data frame now contains the kinship
information along with the simulated outcome variables y1 and y2. Each
row represents a pair of cousins, and the columns include the IDs of the
individuals, their relatedness, and the simulated phenotypic data.</p>
</div>
<div class="section level2">
<h2 id="fitting-a-discordant-kinship-regression-model">Fitting a Discordant-Kinship Regression Model<a class="anchor" aria-label="anchor" href="#fitting-a-discordant-kinship-regression-model"></a>
</h2>
<p>We then use <code><a href="../reference/discord_regression.html">discord_regression()</a></code> to fit a
discordant-kinship model, predicting y1 from y2. Based on the structure
of the data, we expect that there will be a significant association
between the two outcome variables, as there is a known overlapping
non-shared environment covariance.</p>
<p>The model is fit using the <code><a href="../reference/discord_regression.html">discord_regression()</a></code>
function, which takes the following arguments:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/discord_regression.html">discord_regression</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data_demo</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"y1"</span>,</span>
<span>  predictors <span class="op">=</span> <span class="st">"y2"</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>  sex <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  race <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pair_identifiers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"_1"</span>, <span class="st">"_2"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_output</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; stats::lm(formula = stats::as.formula(paste(realOutcome, preds, </span></span>
<span><span class="co">#&gt;     sep = " ~ ")), data = preppedData)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -1.6044 -0.9315 -0.1824  0.7204  2.7929 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  1.21796    0.24153   5.043  8.8e-06 ***</span></span>
<span><span class="co">#&gt; y1_mean      0.08375    0.13099   0.639   0.5260    </span></span>
<span><span class="co">#&gt; y2_diff      0.27022    0.08830   3.060   0.0038 ** </span></span>
<span><span class="co">#&gt; y2_mean      0.11734    0.11812   0.993   0.3261    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 1.117 on 43 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.2033, Adjusted R-squared:  0.1477 </span></span>
<span><span class="co">#&gt; F-statistic: 3.657 on 3 and 43 DF,  p-value: 0.01959</span></span></code></pre></div>
<p>The output of the model includes estimates of the regression
coefficients, standard errors, and p-values for the association between
the two outcome variables.</p>
<p>A nicer regression table can be generated using the
<code>stargazer</code> package, which provides a more user-friendly
format for presenting regression results. The <code>stargazer</code>
function can be used to create a summary table of the model output,
including coefficients, standard errors, and significance levels.</p>
<table style="text-align:center" class="table">
<caption>
<strong>Discordant Kinship Regression Results</strong>
</caption>
<tr>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Statistic
</td>
<td>
N
</td>
<td>
Mean
</td>
<td>
St. Dev.
</td>
<td>
Min
</td>
<td>
Max
</td>
</tr>
<tr>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
y1_diff
</td>
<td>
47
</td>
<td>
1.583
</td>
<td>
1.210
</td>
<td>
0.013
</td>
<td>
4.849
</td>
</tr>
<tr>
<td style="text-align:left">
y1_mean
</td>
<td>
47
</td>
<td>
0.901
</td>
<td>
1.257
</td>
<td>
-2.297
</td>
<td>
4.562
</td>
</tr>
<tr>
<td style="text-align:left">
y2_diff
</td>
<td>
47
</td>
<td>
0.617
</td>
<td>
1.866
</td>
<td>
-3.544
</td>
<td>
4.269
</td>
</tr>
<tr>
<td style="text-align:left">
y2_mean
</td>
<td>
47
</td>
<td>
1.048
</td>
<td>
1.394
</td>
<td>
-1.959
</td>
<td>
3.776
</td>
</tr>
<tr>
<td colspan="6" style="border-bottom: 1px solid black">
</td>
</tr>
</table>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>This vignette demonstrates how {BGmisc} and discord enable
researchers to perform discordant-kinship analyses starting from simple
family data. There’s no need for pre-constructed kinship links or
specialized datasets like the NLSY—just basic family identifiers are
sufficient to generate kinship structures and apply powerful behavior
genetic models.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by S. Mason Garrison, Jonathan Trattner, Yoo Ri Hwang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
