<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Regression demonstration • discord</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Regression demonstration">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">discord</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/categorical_predictors.html">Demonstrating Categorical Predictors in Discordant-Kinship Regressions</a></li>
    <li><a class="dropdown-item" href="../articles/links.html">No Database? No Problem: Using discord with Simple Family Structures</a></li>
    <li><a class="dropdown-item" href="../articles/plots.html">Plots</a></li>
    <li><a class="dropdown-item" href="../articles/Power.html">Power</a></li>
    <li><a class="dropdown-item" href="../articles/regression.html">Regression demonstration</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-Computing-Lab/discord/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="regression_files/kePrint-0.0.1/kePrint.js"></script><link href="regression_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Regression demonstration</h1>
                        <h4 data-toc-skip class="author">Jonathan
Trattner</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/R-Computing-Lab/discord/blob/main/vignettes/regression.Rmd" class="external-link"><code>vignettes/regression.Rmd</code></a></small>
      <div class="d-none name"><code>regression.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette presents a simple example of a discordant-kinship
regression using the <code>discord</code> package.</p>
<p>The analysis draws from work presented by Trattner et al (2020) <span class="citation">(Trattner, Kennon, and Garrison 2020)</span>, which was
initially motivated by reports of health disparities among ethnic
minority groups during the COVID-19 pandemic <span class="citation">(Hooper, Nápoles, and Pérez-Stable 2020)</span>. The
data come from the 1979 National Longitudinal Survey of Youth (NLSY79),
a nationally-representative household probability sample jointly
sponsored by the U.S. Bureau of Labor Statistics and the Department of
Defense. Participants were surveyed annually from 1979 until 1994 at
which point surveys occurred biennially. The data are publicly available
at <a href="https://www.nlsinfo.org/" class="external-link uri">https://www.nlsinfo.org/</a> and include responses from a
biennial flu vaccine survey administered between 2006 and 2016.</p>
<p>The original analysis examined whether socioeconomic status (SES) at
age 40 predicted flu vaccination rates, using a discordant kinship
design. For this vignette, the data were downloaded using the <a href="https://www.nlsinfo.org/investigator/pages/login" class="external-link">NLS
Investigator</a> and are available <a href="https://github.com/R-Computing-Lab/discord/blob/main/data-raw/flu_shot.dat" class="external-link">here</a>.
SES at age 40 values can be found <a href="https://github.com/R-Computing-Lab/discord/blob/main/data-raw/nlsy-ses.csv" class="external-link">here</a>.
For clarity and to emphasize the functionality of {discord}, the data
has been pre-processed using <a href="https://github.com/R-Computing-Lab/discord/blob/main/data-raw/preprocess-discord-flu.R" class="external-link">this
script</a>. This analysis is enabled by recent work that inferred
genetic relatedness for approximately 95% of kin pairs in the NLSY79
cohort <span class="citation">(Rodgers et al. 2016)</span>. These
kinship links are provided in the <a href="https://nlsy-links.github.io/NlsyLinks/index.html" class="external-link">{NlsyLinks}</a>
R package <span class="citation">(Beasley et al. 2016)</span>, and can
be easily utilized with the {discord} package.</p>
<div class="section level3">
<h3 id="data-cleaning">Data Cleaning<a class="anchor" aria-label="anchor" href="#data-cleaning"></a>
</h3>
<p>For this example, we will load the following packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For easy data manipulation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co"># For kinship linkages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlsy-links.github.io/NlsyLinks/" class="external-link">NlsyLinks</a></span><span class="op">)</span></span>
<span><span class="co"># For discordant-kinship regression</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/R-Computing-Lab/discord" class="external-link">discord</a></span><span class="op">)</span></span>
<span><span class="co"># To clean data frame names</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor" class="external-link">janitor</a></span><span class="op">)</span></span>
<span><span class="co"># tidy up output</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/" class="external-link">broom</a></span><span class="op">)</span></span>
<span><span class="co"># pipe</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">data_flu_ses</span><span class="op">)</span></span></code></pre></div>
<p>After preprocessing, we obtain a data frame that contain subject
identifiers, demographic information such as race and sex, and
behavioral variables such as flu vaccination totals and SES at age 40. A
random slice of this dataset is shown below.</p>
<table class="table table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:center;">
CASEID
</th>
<th style="text-align:center;">
RACE
</th>
<th style="text-align:center;">
SEX
</th>
<th style="text-align:center;">
FLU_total
</th>
<th style="text-align:center;">
S00_H40
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
222
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
47.87046
</td>
</tr>
<tr>
<td style="text-align:center;">
493
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
56.78763
</td>
</tr>
<tr>
<td style="text-align:center;">
561
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
75.05756
</td>
</tr>
<tr>
<td style="text-align:center;">
84
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
64.12765
</td>
</tr>
<tr>
<td style="text-align:center;">
590
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
32.22656
</td>
</tr>
<tr>
<td style="text-align:center;">
441
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
23.83602
</td>
</tr>
</tbody>
</table>
<p>Using kinship data from the NlsyLinks package, we restructure the
dataset to better lend itself to discordant kinship analysis. For each
kin pair, the function <code><a href="https://nlsy-links.github.io/NlsyLinks/reference/CreatePairLinks.html" class="external-link">CreatePairLinksSingleEntered()</a></code> takes
a data set like the one above, <strong>[a specification of the NLSY
database and the kin’s relatedness]</strong>, and the variables of
interest. It returns a data frame where each row represents a kin pair,
and each variable appears twice—once for each sibling—using suffixes to
distinguish individuals.</p>
<p>In this example, we examine the relationship between total flu
vaccinations (received between 2006 and 2016) and SES at age 40,
focusing on full siblings. The variable names used in this linkage are
drawn from the preprocessed data previewed above.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get kinship links for individuals with the following variables:</span></span>
<span><span class="va">link_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"FLU_total"</span>, <span class="st">"FLU_2008"</span>, <span class="st">"FLU_2010"</span>,</span>
<span>  <span class="st">"FLU_2012"</span>, <span class="st">"FLU_2014"</span>, <span class="st">"FLU_2016"</span>,</span>
<span>  <span class="st">"S00_H40"</span>, <span class="st">"RACE"</span>, <span class="st">"SEX"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We now link the subjects by the specified variables using
<code><a href="https://nlsy-links.github.io/NlsyLinks/reference/CreatePairLinks.html" class="external-link">CreatePairLinksSingleEntered()</a></code>, from the {NlsyLinks}
package.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify NLSY database and kin relatedness</span></span>
<span><span class="va">link_pairs</span> <span class="op">&lt;-</span> <span class="va">Links79PairExpanded</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">RelationshipPath</span> <span class="op">==</span> <span class="st">"Gen1Housemates"</span> <span class="op">&amp;</span> <span class="va">RFull</span> <span class="op">==</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_link</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nlsy-links.github.io/NlsyLinks/reference/CreatePairLinks.html" class="external-link">CreatePairLinksSingleEntered</a></span><span class="op">(</span></span>
<span>  outcomeDataset <span class="op">=</span> <span class="va">data_flu_ses</span>,</span>
<span>  linksPairDataset <span class="op">=</span> <span class="va">link_pairs</span>,</span>
<span>  outcomeNames <span class="op">=</span> <span class="va">link_vars</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We have saved this data frame as <code>df_link</code>. A random
subset of this data is shown below::<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Each variable name includes the suffix “_S1” and “_S2”,
identifying the sibling to whom the value belongs. The only exception is
the first column, which identifies the kin pair.&lt;/p&gt;"><sup>1</sup></a></p>
<table class="table table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:center;">
ExtendedID
</th>
<th style="text-align:center;">
SubjectTag_S1
</th>
<th style="text-align:center;">
SubjectTag_S2
</th>
<th style="text-align:center;">
FLU_total_S1
</th>
<th style="text-align:center;">
FLU_total_S2
</th>
<th style="text-align:center;">
S00_H40_S1
</th>
<th style="text-align:center;">
S00_H40_S2
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
1184
</td>
<td style="text-align:center;">
118400
</td>
<td style="text-align:center;">
118500
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
85.50907
</td>
<td style="text-align:center;">
92.97715
</td>
</tr>
<tr>
<td style="text-align:center;">
210
</td>
<td style="text-align:center;">
21000
</td>
<td style="text-align:center;">
21100
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
80.72205
</td>
<td style="text-align:center;">
73.67061
</td>
</tr>
<tr>
<td style="text-align:center;">
1366
</td>
<td style="text-align:center;">
136700
</td>
<td style="text-align:center;">
136800
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
85.67288
</td>
<td style="text-align:center;">
55.05292
</td>
</tr>
<tr>
<td style="text-align:center;">
1575
</td>
<td style="text-align:center;">
157500
</td>
<td style="text-align:center;">
157700
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
82.47228
</td>
<td style="text-align:center;">
50.07675
</td>
</tr>
<tr>
<td style="text-align:center;">
1675
</td>
<td style="text-align:center;">
167500
</td>
<td style="text-align:center;">
167700
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
88.99530
</td>
<td style="text-align:center;">
49.19417
</td>
</tr>
<tr>
<td style="text-align:center;">
666
</td>
<td style="text-align:center;">
66600
</td>
<td style="text-align:center;">
66700
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
27.04217
</td>
<td style="text-align:center;">
68.63659
</td>
</tr>
</tbody>
</table>
<p>This data is almost ready for analysis, but we want to ensure that
the data are representative of actual trends. The <code>FLU_total</code>
column is simply a sum of the biennial survey responses. So for a given
sibling-pair, one or both individuals may not have responded to the
survey indicating their vaccination status. If that’s the case, we want
to exclude those siblings to reduce <strong>[non-response
bias]</strong>, by examining the biennial responses and removing any
rows with missingness.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Take the linked data, group by the sibling pairs and</span></span>
<span><span class="co"># count the number of responses for flu each year. If there is an NA,</span></span>
<span><span class="co"># then data is missing for one of the years, and we omit it.</span></span>
<span><span class="va">consistent_kin</span> <span class="op">&lt;-</span> <span class="va">df_link</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">SubjectTag_S1</span>, <span class="va">SubjectTag_S2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span></span>
<span>    <span class="va">FLU_2008_S1</span>, <span class="va">FLU_2010_S1</span>,</span>
<span>    <span class="va">FLU_2012_S1</span>, <span class="va">FLU_2014_S1</span>,</span>
<span>    <span class="va">FLU_2016_S1</span>, <span class="va">FLU_2008_S2</span>,</span>
<span>    <span class="va">FLU_2010_S2</span>, <span class="va">FLU_2012_S2</span>,</span>
<span>    <span class="va">FLU_2014_S2</span>, <span class="va">FLU_2016_S2</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the flu_modeling_data object with only consistent responders.</span></span>
<span><span class="co"># Clean the column names with the {janitor} package.</span></span>
<span><span class="va">flu_modeling_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html" class="external-link">semi_join</a></span><span class="op">(</span><span class="va">df_link</span>,</span>
<span>  <span class="va">consistent_kin</span>,</span>
<span>  by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"SubjectTag_S1"</span>,</span>
<span>    <span class="st">"SubjectTag_S2"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html" class="external-link">clean_names</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>To avoid violating assumptions of independence, in our analysis we
specify that the kin-pairs should be from unique households (i.e. we
randomly select one sibling pair per household).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flu_modeling_data</span> <span class="op">&lt;-</span> <span class="va">flu_modeling_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">extended_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_sample</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The data we will use for modeling now contains additional information
for each member of the kin pair, including sex and race of each
individual, flu vaccination status for the biennial survey between
2006-2016, and a total flu vaccination count for that period. The total
vaccination count ranges from 0 - 5, where 0 indicates that the
individual did not get a vaccine in any year between 2006-2016 and 5
indicates that an individual got at least 5 vaccines between 2006-2016.
Although our data set has individual years, we focused on the aggregate
as we felt that was a measure of general tendency. A subset of the data
to use in this regression looks like:</p>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:center;">
extended_id
</th>
<th style="text-align:center;">
subject_tag_s1
</th>
<th style="text-align:center;">
subject_tag_s2
</th>
<th style="text-align:center;">
flu_total_s1
</th>
<th style="text-align:center;">
flu_total_s2
</th>
<th style="text-align:center;">
race_s1
</th>
<th style="text-align:center;">
race_s2
</th>
<th style="text-align:center;">
sex_s1
</th>
<th style="text-align:center;">
sex_s2
</th>
<th style="text-align:center;">
ses_age_40_s1
</th>
<th style="text-align:center;">
ses_age_40_s2
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;text-align: center;">
17
</td>
<td style="text-align:center;text-align: center;">
1700
</td>
<td style="text-align:center;text-align: center;">
1800
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
1
</td>
<td style="text-align:center;text-align: center;">
1
</td>
<td style="text-align:center;text-align: center;">
49.26537
</td>
<td style="text-align:center;text-align: center;">
74.92440
</td>
</tr>
<tr>
<td style="text-align:center;text-align: center;">
29
</td>
<td style="text-align:center;text-align: center;">
2900
</td>
<td style="text-align:center;text-align: center;">
3000
</td>
<td style="text-align:center;text-align: center;">
2
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
56.80481
</td>
<td style="text-align:center;text-align: center;">
32.05423
</td>
</tr>
<tr>
<td style="text-align:center;text-align: center;">
37
</td>
<td style="text-align:center;text-align: center;">
3700
</td>
<td style="text-align:center;text-align: center;">
3800
</td>
<td style="text-align:center;text-align: center;">
1
</td>
<td style="text-align:center;text-align: center;">
5
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
58.55547
</td>
<td style="text-align:center;text-align: center;">
50.45408
</td>
</tr>
<tr>
<td style="text-align:center;text-align: center;">
40
</td>
<td style="text-align:center;text-align: center;">
4000
</td>
<td style="text-align:center;text-align: center;">
4100
</td>
<td style="text-align:center;text-align: center;">
2
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
1
</td>
<td style="text-align:center;text-align: center;">
1
</td>
<td style="text-align:center;text-align: center;">
78.19220
</td>
<td style="text-align:center;text-align: center;">
73.41860
</td>
</tr>
<tr>
<td style="text-align:center;text-align: center;">
58
</td>
<td style="text-align:center;text-align: center;">
5800
</td>
<td style="text-align:center;text-align: center;">
5900
</td>
<td style="text-align:center;text-align: center;">
5
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
1
</td>
<td style="text-align:center;text-align: center;">
80.56835
</td>
<td style="text-align:center;text-align: center;">
49.68414
</td>
</tr>
<tr>
<td style="text-align:center;text-align: center;">
61
</td>
<td style="text-align:center;text-align: center;">
6100
</td>
<td style="text-align:center;text-align: center;">
6200
</td>
<td style="text-align:center;text-align: center;">
3
</td>
<td style="text-align:center;text-align: center;">
4
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
74.43720
</td>
<td style="text-align:center;text-align: center;">
50.56920
</td>
</tr>
<tr>
<td style="text-align:center;text-align: center;">
67
</td>
<td style="text-align:center;text-align: center;">
6700
</td>
<td style="text-align:center;text-align: center;">
6800
</td>
<td style="text-align:center;text-align: center;">
4
</td>
<td style="text-align:center;text-align: center;">
4
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
1
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
89.67767
</td>
<td style="text-align:center;text-align: center;">
82.68649
</td>
</tr>
<tr>
<td style="text-align:center;text-align: center;">
74
</td>
<td style="text-align:center;text-align: center;">
7500
</td>
<td style="text-align:center;text-align: center;">
7600
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
1
</td>
<td style="text-align:center;text-align: center;">
88.15524
</td>
<td style="text-align:center;text-align: center;">
61.54234
</td>
</tr>
<tr>
<td style="text-align:center;text-align: center;">
83
</td>
<td style="text-align:center;text-align: center;">
8300
</td>
<td style="text-align:center;text-align: center;">
8400
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
3
</td>
<td style="text-align:center;text-align: center;">
1
</td>
<td style="text-align:center;text-align: center;">
1
</td>
<td style="text-align:center;text-align: center;">
1
</td>
<td style="text-align:center;text-align: center;">
1
</td>
<td style="text-align:center;text-align: center;">
46.41507
</td>
<td style="text-align:center;text-align: center;">
64.12765
</td>
</tr>
<tr>
<td style="text-align:center;text-align: center;">
85
</td>
<td style="text-align:center;text-align: center;">
8600
</td>
<td style="text-align:center;text-align: center;">
8700
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
4
</td>
<td style="text-align:center;text-align: center;">
1
</td>
<td style="text-align:center;text-align: center;">
1
</td>
<td style="text-align:center;text-align: center;">
0
</td>
<td style="text-align:center;text-align: center;">
1
</td>
<td style="text-align:center;text-align: center;">
45.06552
</td>
<td style="text-align:center;text-align: center;">
64.14045
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="modeling-and-interpretation">Modeling and Interpretation<a class="anchor" aria-label="anchor" href="#modeling-and-interpretation"></a>
</h3>
<p>To perform the regression using the {discord} package, we supply the
data frame and specify the outcome and predictors. It also requires a
kinship pair id, <code>extended_id</code> in our case, as well as pair
identifiers – the column name suffixes that identify to which kin a
column’s values correspond (“_s1” and “_s2” in our case).<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Note these ids were previously “_S1” and “_S2”, however,
we used the &lt;code&gt;&lt;a href="https://sfirke.github.io/janitor/reference/clean_names.html" class="external-link"&gt;clean_names()&lt;/a&gt;&lt;/code&gt; function which coerced the column
names to lowercase.&lt;/p&gt;'><sup>2</sup></a> Optional, although
recommended, are columns containing sex and race information to control
for as additional covariates. In our case, these columns are prefixed
“race” and “sex”. Per the <a href="https://github.com/R-Computing-Lab/discord/blob/main/data-raw/preprocess-discord-flu.R" class="external-link">pre-processing
script</a>, these columns contain dummy variables where the reference
group for race is “non-Black, non-Hispanic” and the reference group for
sex is female.</p>
<p>By entering this information into the
<code><a href="../reference/discord_regression.html">discord_regression()</a></code> function, we can run the model as
such:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Setting a seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">18</span><span class="op">)</span></span>
<span><span class="va">flu_model_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/discord_regression.html">discord_regression</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flu_modeling_data</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"flu_total"</span>,</span>
<span>  predictors <span class="op">=</span> <span class="st">"s00_h40"</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"extended_id"</span>,</span>
<span>  sex <span class="op">=</span> <span class="st">"sex"</span>,</span>
<span>  race <span class="op">=</span> <span class="st">"race"</span>,</span>
<span>  pair_identifiers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"_s1"</span>, <span class="st">"_s2"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The default output of <code><a href="../reference/discord_regression.html">discord_regression()</a></code> is an
<code>lm</code> object. The metrics for our regression can be summarized
as follows:</p>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:center;">
Term
</th>
<th style="text-align:center;">
Estimate
</th>
<th style="text-align:center;">
Standard Error
</th>
<th style="text-align:center;">
T Statistic
</th>
<th style="text-align:center;">
P Value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;text-align: center;">
(Intercept)
</td>
<td style="text-align:center;text-align: center;">
1.428
</td>
<td style="text-align:center;text-align: center;">
0.194
</td>
<td style="text-align:center;text-align: center;">
7.365
</td>
<td style="text-align:center;text-align: center;">
p&lt;0.001
</td>
</tr>
<tr>
<td style="text-align:center;text-align: center;">
flu_total_mean
</td>
<td style="text-align:center;text-align: center;">
0.194
</td>
<td style="text-align:center;text-align: center;">
0.034
</td>
<td style="text-align:center;text-align: center;">
5.751
</td>
<td style="text-align:center;text-align: center;">
p&lt;0.001
</td>
</tr>
<tr>
<td style="text-align:center;text-align: center;">
s00_h40_diff
</td>
<td style="text-align:center;text-align: center;">
0.006
</td>
<td style="text-align:center;text-align: center;">
0.002
</td>
<td style="text-align:center;text-align: center;">
2.981
</td>
<td style="text-align:center;text-align: center;">
p=0.003
</td>
</tr>
<tr>
<td style="text-align:center;text-align: center;">
s00_h40_mean
</td>
<td style="text-align:center;text-align: center;">
0.002
</td>
<td style="text-align:center;text-align: center;">
0.003
</td>
<td style="text-align:center;text-align: center;">
0.873
</td>
<td style="text-align:center;text-align: center;">
p=0.383
</td>
</tr>
<tr>
<td style="text-align:center;text-align: center;">
sex_1
</td>
<td style="text-align:center;text-align: center;">
-0.078
</td>
<td style="text-align:center;text-align: center;">
0.099
</td>
<td style="text-align:center;text-align: center;">
-0.789
</td>
<td style="text-align:center;text-align: center;">
p=0.430
</td>
</tr>
<tr>
<td style="text-align:center;text-align: center;">
race_1
</td>
<td style="text-align:center;text-align: center;">
-0.061
</td>
<td style="text-align:center;text-align: center;">
0.104
</td>
<td style="text-align:center;text-align: center;">
-0.583
</td>
<td style="text-align:center;text-align: center;">
p=0.560
</td>
</tr>
<tr>
<td style="text-align:center;text-align: center;">
sex_2
</td>
<td style="text-align:center;text-align: center;">
-0.017
</td>
<td style="text-align:center;text-align: center;">
0.099
</td>
<td style="text-align:center;text-align: center;">
-0.169
</td>
<td style="text-align:center;text-align: center;">
p=0.866
</td>
</tr>
</tbody>
</table>
<p>Looking at this output, the intercept can be thought of as the
average difference in outcomes between siblings, controlling for all
other variables. That is, it estimates the expected difference for two
sisters of a non-minority ethnic background (the reference groups for
sex and race), when SES and all other predictors are equal –
approximately 1.4. The term <code>flu_total_mean</code> is essentially
an extra component of the intercept that adjusts for between-family
differences in the outcome variable. It allows the model to capture how
the expected difference between siblings changes as a function of their
average level of flu vaccinations, helping to avoid misattributing
between-family differences to within-family effects.</p>
<p>The next term, <code>s00_h40_mean</code>, represents the mean
socioeconomic status for the siblings. Like <code>flu_total_mean</code>,
it adjusts the expected difference to reflect between-family variation
in SES. We also accounted for sex and race, neither of which have a
statistically significant effect on the differences in flu vaccine shots
between siblings (different families) or within a sibling pair (same
family).</p>
<p>The most important metric from the output, though, is the difference
score, <code>s00_h40_diff</code>. Here, it is statistically significant.
An interpretation of this result might be, “the difference in
socioeconomic status between siblings at age 40 is positively associated
with the difference in the number of flu vaccinations received between
2006-2016.” This finding means that a sibling with 10% higher SES is
expected to have 0.0612687 average in flu shots.</p>
<p>The goal of performing a discordant-kinship regression is to see
whether there is a significant difference in some behavioral measure
while controlling for as much gene-and-environmental variance as
possible. In this section, we walked through an analysis showing a
statistically significant difference in the number of flu shots a
sibling received and their socioeconomic status. From this finding, we
<em>could not</em> claim the relationship is causal. However, we cannot
eliminate causality because there are statistically significant within-
and between-family differences in our predictors and outcomes.</p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>In its current implementation, the {discord} package encourages best
practices for performing discordant-kinship regressions. For example,
the main function has the default expectation that sex and race
indicators will be supplied. These measures are both important
covariates <strong>when testing for causality between familial
background and psychological characteristics.</strong></p>
<p>This, and other design choices, are crucial to facilitating
transparent and reproducible results. Software ever-evolves, however,
and to further support reproducible research we plan to provide improved
documentation and allow for easier inspection of the underlying model
implementation and results.</p>
</div>
<div class="section level2">
<h2 id="acknowledgments">Acknowledgments<a class="anchor" aria-label="anchor" href="#acknowledgments"></a>
</h2>
<p>We acknowledge contributions from Cermet Ream, Joe Rodgers, and
support from Lucy D’Agostino McGowan on this project.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-beasley2016" class="csl-entry">
Beasley, Will, Joe Rodgers, David Bard, Michael Hunter, S. Mason
Garrison, and Kelly Meredith. 2016. <em>NlsyLinks: Utilities and Kinship
Information for Research with the NLSY</em>. <a href="https://CRAN.R-project.org/package=NlsyLinks" class="external-link">https://CRAN.R-project.org/package=NlsyLinks</a>.
</div>
<div id="ref-hooper2020" class="csl-entry">
Hooper, Monica Webb, Anna María Nápoles, and Eliseo J. Pérez-Stable.
2020. <span>“COVID-19 and Racial/Ethnic Disparities.”</span>
<em>JAMA</em>, May. <a href="https://doi.org/10.1001/jama.2020.8598" class="external-link">https://doi.org/10.1001/jama.2020.8598</a>.
</div>
<div id="ref-rodgers2016" class="csl-entry">
Rodgers, Joseph Lee, William H. Beasley, David E. Bard, Kelly M.
Meredith, Michael D. Hunter, Amber B. Johnson, Maury Buster, et al.
2016. <span>“The NLSY Kinship Links: Using the NLSY79 and NLSY-Children
Data to Conduct Genetically-Informed and Family-Oriented
Research.”</span> <em>Behavior Genetics</em> 46 (4): 538–51. <a href="https://doi.org/10.1007/s10519-016-9785-3" class="external-link">https://doi.org/10.1007/s10519-016-9785-3</a>.
</div>
<div id="ref-jonathantrattner2020" class="csl-entry">
Trattner, Jonathan, Later Kennon, and S. Mason Garrison. 2020.
<span>“Vaccine Willingness and Socioeconomic Status: A Biometrically
Controlled Design.”</span> <em>Behavior Genetics</em>, Behavior Genetics
Association 50th Annual Meeting Abstracts, 50 (6): 483–83. <a href="https://doi.org/10.1007/s10519-020-10018-8" class="external-link">https://doi.org/10.1007/s10519-020-10018-8</a>.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by S. Mason Garrison, Jonathan Trattner, Yoo Ri Hwang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
