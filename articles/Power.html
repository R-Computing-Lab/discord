<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Power • discord</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Power">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">discord</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/categorical_predictors.html">Demonstrating categorical predictors</a></li>
    <li><a class="dropdown-item" href="../articles/full_data_workflow.html">Full Data Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/links.html">No Database? No Problem: Using discord with Simple Family Structures</a></li>
    <li><a class="dropdown-item" href="../articles/plots.html">Plots</a></li>
    <li><a class="dropdown-item" href="../articles/Power.html">Power</a></li>
    <li><a class="dropdown-item" href="../articles/regression.html">NLSY: Regression demonstration with Flu Vaccination and SES data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-Computing-Lab/discord/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Power</h1>
                        <h4 data-toc-skip class="author">S. Mason
Garrison</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/R-Computing-Lab/discord/blob/main/vignettes/Power.Rmd" class="external-link"><code>vignettes/Power.Rmd</code></a></small>
      <div class="d-none name"><code>Power.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette demonstrates how to conduct simulation-based power
analysis for discordant sibling designs. These designs estimate causal
effects by comparing differences between genetically related
individuals, controlling for shared background.</p>
<p>We simulate multivariate phenotypes using the <code><a href="../reference/kinsim.html">kinsim()</a></code>
function, fit regression models of interest, and calculate empirical
power across multiple design conditions.</p>
</div>
<div class="section level2">
<h2 id="function-overview-kinsim">Function Overview: kinsim()<a class="anchor" aria-label="anchor" href="#function-overview-kinsim"></a>
</h2>
<p>The <code><a href="../reference/kinsim.html">kinsim()</a></code> function is designed to simulate data for
kinship studies. It generates paired multivariate data informed by
biometric models (ACE), supporting variable relatedness levels and
covariance structures.</p>
<div class="section level3">
<h3 id="key-arguments">Key Arguments<a class="anchor" aria-label="anchor" href="#key-arguments"></a>
</h3>
<table class="table">
<colgroup>
<col width="43%">
<col width="56%">
</colgroup>
<thead><tr class="header">
<th>Argument</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>r_all</code></td>
<td>Vector of genetic relatedness values (e.g., <code>1</code>,
<code>0.5</code>, <code>0.25</code>, <code>0</code>)</td>
</tr>
<tr class="even">
<td><code>npergroup_all</code></td>
<td>Sample sizes for each level of relatedness</td>
</tr>
<tr class="odd">
<td><code>ace_list</code></td>
<td>Matrix of ACE parameters per variable (rows = traits; columns = a,
c, e)</td>
</tr>
<tr class="even">
<td>
<code>cov_a</code>, <code>cov_c</code>, <code>cov_e</code>
</td>
<td>Cross-variable covariance for A, C, and E components</td>
</tr>
<tr class="odd">
<td><code>mu_list</code></td>
<td>Mean values for each phenotype</td>
</tr>
<tr class="even">
<td><code>r_vector</code></td>
<td>Optional: pairwise relatedness at the observation level</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h3>
<p>A data.frame with:</p>
<ul>
<li><p>Latent variables: A, C, E for each phenotype and sibling</p></li>
<li><p>Phenotypic outcomes: y1 and y2 for both phenotypes</p></li>
<li><p>Metadata: relatedness level (r) and pair id</p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="example-usage">Example Usage<a class="anchor" aria-label="anchor" href="#example-usage"></a>
</h2>
<div class="section level3">
<h3 id="step-1-define-simulation-grid">Step 1: Define Simulation Grid<a class="anchor" aria-label="anchor" href="#step-1-define-simulation-grid"></a>
</h3>
<p>We define a grid of simulation conditions, varying genetic
relatedness, ACE variance components, and genetic correlations.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlsy-links.github.io/NlsyLinks/" class="external-link">NlsyLinks</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/R-Computing-Lab/discord" class="external-link">discord</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">utils</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co"># Set random seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1492</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Disable scientific notation for clarity</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>scipen <span class="op">=</span> <span class="fl">999</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">conditions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>  total_pairs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">250</span>, <span class="fl">500</span>, <span class="fl">750</span>, <span class="fl">1000</span><span class="op">)</span>,</span>
<span>  relatedness <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">.5</span><span class="op">)</span>,</span>
<span>  cov_a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>  cov_c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>  cov_e <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>  ace_a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>  ace_c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>  ace_e <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-2-run-simulations">Step 2: Run Simulations<a class="anchor" aria-label="anchor" href="#step-2-run-simulations"></a>
</h3>
<p>For each condition, we simulate 100 replications of fitting
discordant sibling models. We have kept the number of trials low for
demonstration purposes, but you can increase <code>n_trials</code> for
more robust power estimates.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1492</span><span class="op">)</span> <span class="co"># Set seed for reproducibility</span></span>
<span><span class="va">n_trials</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">FAST</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span> <span class="co"># Set to FALSE for slower, more detailed analysis</span></span>
<span><span class="va">results_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">name.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"coef_xdiff"</span>, <span class="st">"p_xdiff"</span>, <span class="st">"r.squared"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">cond</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">conditions</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">current</span> <span class="op">&lt;-</span> <span class="va">conditions</span><span class="op">[</span><span class="va">cond</span>, <span class="op">]</span></span>
<span>  <span class="va">temp_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">n_trials</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">name.results</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">temp_results</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">name.results</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_trials</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">trial</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kinsim.html">kinsim</a></span><span class="op">(</span></span>
<span>      r_vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">current</span><span class="op">$</span><span class="va">relatedness</span>, each <span class="op">=</span> <span class="va">current</span><span class="op">$</span><span class="va">total_pairs</span><span class="op">)</span>,</span>
<span>      npg_all <span class="op">=</span> <span class="va">current</span><span class="op">$</span><span class="va">total_pairs</span>,</span>
<span>      ace_all <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">current</span><span class="op">$</span><span class="va">ace_a</span>, <span class="va">current</span><span class="op">$</span><span class="va">ace_c</span>, <span class="va">current</span><span class="op">$</span><span class="va">ace_e</span><span class="op">)</span>,</span>
<span>      cov_a <span class="op">=</span> <span class="va">current</span><span class="op">$</span><span class="va">cov_a</span>,</span>
<span>      cov_c <span class="op">=</span> <span class="va">current</span><span class="op">$</span><span class="va">cov_c</span>,</span>
<span>      cov_e <span class="op">=</span> <span class="va">current</span><span class="op">$</span><span class="va">cov_e</span>,</span>
<span>      variables <span class="op">=</span> <span class="fl">2</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="va">extract</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      id <span class="op">=</span> <span class="va">trial</span><span class="op">$</span><span class="va">id</span>, r <span class="op">=</span> <span class="va">trial</span><span class="op">$</span><span class="va">r</span>,</span>
<span>      y_s1 <span class="op">=</span> <span class="va">trial</span><span class="op">$</span><span class="va">y1_1</span>, y_s2 <span class="op">=</span> <span class="va">trial</span><span class="op">$</span><span class="va">y1_2</span>,</span>
<span>      x_s1 <span class="op">=</span> <span class="va">trial</span><span class="op">$</span><span class="va">y2_1</span>, x_s2 <span class="op">=</span> <span class="va">trial</span><span class="op">$</span><span class="va">y2_2</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">FAST</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="co"># faster</span></span>
<span>      <span class="co"># double enter the data</span></span>
<span>      <span class="va">extract2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">extract</span>,</span>
<span>          y_s1 <span class="op">=</span> <span class="va">y_s2</span>, y_s2 <span class="op">=</span> <span class="va">y_s1</span>,</span>
<span>          x_s1 <span class="op">=</span> <span class="va">x_s2</span>, x_s2 <span class="op">=</span> <span class="va">x_s1</span></span>
<span>        <span class="op">)</span>,</span>
<span>        <span class="va">extract</span></span>
<span>      <span class="op">)</span></span>
<span>      <span class="va">extract2</span><span class="op">$</span><span class="va">y_diff</span> <span class="op">&lt;-</span> <span class="va">extract2</span><span class="op">$</span><span class="va">y_s1</span> <span class="op">-</span> <span class="va">extract2</span><span class="op">$</span><span class="va">y_s2</span></span>
<span>      <span class="va">extract2</span><span class="op">$</span><span class="va">x_diff</span> <span class="op">&lt;-</span> <span class="va">extract2</span><span class="op">$</span><span class="va">x_s1</span> <span class="op">-</span> <span class="va">extract2</span><span class="op">$</span><span class="va">x_s2</span></span>
<span>      <span class="va">extract2</span><span class="op">$</span><span class="va">x_bar</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">extract2</span><span class="op">$</span><span class="va">x_s1</span> <span class="op">+</span> <span class="va">extract2</span><span class="op">$</span><span class="va">x_s2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span>      <span class="va">extract2</span><span class="op">$</span><span class="va">y_bar</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">extract2</span><span class="op">$</span><span class="va">y_s1</span> <span class="op">+</span> <span class="va">extract2</span><span class="op">$</span><span class="va">y_s2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span></span>
<span>      <span class="co"># select pair with ydiff &gt; 0</span></span>
<span>      <span class="va">extract3</span> <span class="op">&lt;-</span> <span class="va">extract2</span><span class="op">[</span><span class="va">extract2</span><span class="op">$</span><span class="va">y_diff</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="op">]</span></span>
<span></span>
<span>      <span class="va">fit</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y_diff</span> <span class="op">~</span> <span class="va">x_bar</span> <span class="op">+</span> <span class="va">y_bar</span> <span class="op">+</span> <span class="va">x_diff</span>, data <span class="op">=</span> <span class="va">extract3</span><span class="op">)</span>,</span>
<span>        error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="co"># slower</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">FAST</span> <span class="op">==</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">fit</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="../reference/discord_regression.html">discord_regression</a></span><span class="op">(</span></span>
<span>          data <span class="op">=</span> <span class="va">extract</span>, outcome <span class="op">=</span> <span class="st">"y"</span>, predictors <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>          id <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>          sex <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>          race <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>          fast <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>        <span class="op">)</span>,</span>
<span>        error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">sm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span>      <span class="va">temp_results</span><span class="op">[</span><span class="va">i</span>, <span class="st">"coef_xdiff"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">sm</span><span class="op">)</span><span class="op">[</span><span class="st">"x_diff"</span>, <span class="st">"Estimate"</span><span class="op">]</span></span>
<span>      <span class="va">temp_results</span><span class="op">[</span><span class="va">i</span>, <span class="st">"p_xdiff"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">sm</span><span class="op">)</span><span class="op">[</span><span class="st">"x_diff"</span>, <span class="st">"Pr(&gt;|t|)"</span><span class="op">]</span></span>
<span>      <span class="va">temp_results</span><span class="op">[</span><span class="va">i</span>, <span class="st">"r.squared"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">sm</span><span class="op">$</span><span class="va">r.squared</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">results_list</span><span class="op">[[</span><span class="va">cond</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">temp_results</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-3-summarize-power">Step 3: Summarize Power<a class="anchor" aria-label="anchor" href="#step-3-summarize-power"></a>
</h3>
<p>Our final step is to summarize the power across all conditions. We
calculate the proportion of trials where the p-value for the difference
in means (<code>p_xdiff</code>) is less than 0.05, and we also report
the median R-squared value from the regression models. Note that we’ve
limited the number of trials to 10 for demonstration purposes, but you
can (and should) increase this for more robust estimates.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">power_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">results_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    power_xdiff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">p_xdiff</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    median_r2   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">r.squared</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">final_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">conditions</span>, <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">power_summary</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-4-visualize-power">Step 4: Visualize Power<a class="anchor" aria-label="anchor" href="#step-4-visualize-power"></a>
</h3>
<p>We can visualize the power estimates across different conditions. The
plots below show the power estimates for each condition, including the
total number of pairs, relatedness level, covariate settings, and the
median R-squared value from the regression models. As expected, power
increases with the number of pairs and is influenced by the relatedness
level and covariate settings. In the plots below, we visualize the power
estimates across different conditions, focusing on the impact of
covariates and relatedness levels.</p>
<p><img src="Power_files/figure-html/plot-power-1.png" width="672"><img src="Power_files/figure-html/plot-power-2.png" width="672"></p>
<div class="section level4">
<h4 id="power-table">Power Table<a class="anchor" aria-label="anchor" href="#power-table"></a>
</h4>
<p>The table below summarizes the power estimates across different
conditions. The <code>power_xdiff</code> column indicates the proportion
of trials where the p-value for the difference in means
(<code>p_xdiff</code>) is less than 0.05, and the <code>median_r2</code>
column reports the median R-squared value from the regression
models.</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="9%">
<col width="9%">
<col width="15%">
<col width="15%">
<col width="15%">
<col width="4%">
<col width="4%">
<col width="4%">
<col width="9%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="right">total_pairs</th>
<th align="right">relatedness</th>
<th align="left">cov_a</th>
<th align="left">cov_c</th>
<th align="left">cov_e</th>
<th align="right">ace_a</th>
<th align="right">ace_c</th>
<th align="right">ace_e</th>
<th align="right">power_xdiff</th>
<th align="right">median_r2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">100</td>
<td align="right">1.0</td>
<td align="left">No Covariate A</td>
<td align="left">No Covariate C</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.03</td>
<td align="right">0.0201218</td>
</tr>
<tr class="even">
<td align="right">250</td>
<td align="right">1.0</td>
<td align="left">No Covariate A</td>
<td align="left">No Covariate C</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0089694</td>
</tr>
<tr class="odd">
<td align="right">500</td>
<td align="right">1.0</td>
<td align="left">No Covariate A</td>
<td align="left">No Covariate C</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.02</td>
<td align="right">0.0045342</td>
</tr>
<tr class="even">
<td align="right">750</td>
<td align="right">1.0</td>
<td align="left">No Covariate A</td>
<td align="left">No Covariate C</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.06</td>
<td align="right">0.0038589</td>
</tr>
<tr class="odd">
<td align="right">1000</td>
<td align="right">1.0</td>
<td align="left">No Covariate A</td>
<td align="left">No Covariate C</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0018504</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="right">0.5</td>
<td align="left">No Covariate A</td>
<td align="left">No Covariate C</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0238725</td>
</tr>
<tr class="odd">
<td align="right">250</td>
<td align="right">0.5</td>
<td align="left">No Covariate A</td>
<td align="left">No Covariate C</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.05</td>
<td align="right">0.0105100</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">0.5</td>
<td align="left">No Covariate A</td>
<td align="left">No Covariate C</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.06</td>
<td align="right">0.0056736</td>
</tr>
<tr class="odd">
<td align="right">750</td>
<td align="right">0.5</td>
<td align="left">No Covariate A</td>
<td align="left">No Covariate C</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.03</td>
<td align="right">0.0201218</td>
</tr>
<tr class="even">
<td align="right">1000</td>
<td align="right">0.5</td>
<td align="left">No Covariate A</td>
<td align="left">No Covariate C</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0089694</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">1.0</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">No Covariate C</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.02</td>
<td align="right">0.0045342</td>
</tr>
<tr class="even">
<td align="right">250</td>
<td align="right">1.0</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">No Covariate C</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.06</td>
<td align="right">0.0038589</td>
</tr>
<tr class="odd">
<td align="right">500</td>
<td align="right">1.0</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">No Covariate C</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0018504</td>
</tr>
<tr class="even">
<td align="right">750</td>
<td align="right">1.0</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">No Covariate C</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0238725</td>
</tr>
<tr class="odd">
<td align="right">1000</td>
<td align="right">1.0</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">No Covariate C</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.05</td>
<td align="right">0.0105100</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="right">0.5</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">No Covariate C</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.06</td>
<td align="right">0.0056736</td>
</tr>
<tr class="odd">
<td align="right">250</td>
<td align="right">0.5</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">No Covariate C</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.03</td>
<td align="right">0.0201218</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">0.5</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">No Covariate C</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0089694</td>
</tr>
<tr class="odd">
<td align="right">750</td>
<td align="right">0.5</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">No Covariate C</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.02</td>
<td align="right">0.0045342</td>
</tr>
<tr class="even">
<td align="right">1000</td>
<td align="right">0.5</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">No Covariate C</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.06</td>
<td align="right">0.0038589</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">1.0</td>
<td align="left">No Covariate A</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0018504</td>
</tr>
<tr class="even">
<td align="right">250</td>
<td align="right">1.0</td>
<td align="left">No Covariate A</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0238725</td>
</tr>
<tr class="odd">
<td align="right">500</td>
<td align="right">1.0</td>
<td align="left">No Covariate A</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.05</td>
<td align="right">0.0105100</td>
</tr>
<tr class="even">
<td align="right">750</td>
<td align="right">1.0</td>
<td align="left">No Covariate A</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.06</td>
<td align="right">0.0056736</td>
</tr>
<tr class="odd">
<td align="right">1000</td>
<td align="right">1.0</td>
<td align="left">No Covariate A</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.03</td>
<td align="right">0.0201218</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="right">0.5</td>
<td align="left">No Covariate A</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0089694</td>
</tr>
<tr class="odd">
<td align="right">250</td>
<td align="right">0.5</td>
<td align="left">No Covariate A</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.02</td>
<td align="right">0.0045342</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">0.5</td>
<td align="left">No Covariate A</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.06</td>
<td align="right">0.0038589</td>
</tr>
<tr class="odd">
<td align="right">750</td>
<td align="right">0.5</td>
<td align="left">No Covariate A</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0018504</td>
</tr>
<tr class="even">
<td align="right">1000</td>
<td align="right">0.5</td>
<td align="left">No Covariate A</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0238725</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">1.0</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.05</td>
<td align="right">0.0105100</td>
</tr>
<tr class="even">
<td align="right">250</td>
<td align="right">1.0</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.06</td>
<td align="right">0.0056736</td>
</tr>
<tr class="odd">
<td align="right">500</td>
<td align="right">1.0</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.03</td>
<td align="right">0.0201218</td>
</tr>
<tr class="even">
<td align="right">750</td>
<td align="right">1.0</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0089694</td>
</tr>
<tr class="odd">
<td align="right">1000</td>
<td align="right">1.0</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.02</td>
<td align="right">0.0045342</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="right">0.5</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.06</td>
<td align="right">0.0038589</td>
</tr>
<tr class="odd">
<td align="right">250</td>
<td align="right">0.5</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0018504</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">0.5</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0238725</td>
</tr>
<tr class="odd">
<td align="right">750</td>
<td align="right">0.5</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.05</td>
<td align="right">0.0105100</td>
</tr>
<tr class="even">
<td align="right">1000</td>
<td align="right">0.5</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">No Covariate E</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.06</td>
<td align="right">0.0056736</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">1.0</td>
<td align="left">No Covariate A</td>
<td align="left">No Covariate C</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.03</td>
<td align="right">0.0201218</td>
</tr>
<tr class="even">
<td align="right">250</td>
<td align="right">1.0</td>
<td align="left">No Covariate A</td>
<td align="left">No Covariate C</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0089694</td>
</tr>
<tr class="odd">
<td align="right">500</td>
<td align="right">1.0</td>
<td align="left">No Covariate A</td>
<td align="left">No Covariate C</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.02</td>
<td align="right">0.0045342</td>
</tr>
<tr class="even">
<td align="right">750</td>
<td align="right">1.0</td>
<td align="left">No Covariate A</td>
<td align="left">No Covariate C</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.06</td>
<td align="right">0.0038589</td>
</tr>
<tr class="odd">
<td align="right">1000</td>
<td align="right">1.0</td>
<td align="left">No Covariate A</td>
<td align="left">No Covariate C</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0018504</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="right">0.5</td>
<td align="left">No Covariate A</td>
<td align="left">No Covariate C</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0238725</td>
</tr>
<tr class="odd">
<td align="right">250</td>
<td align="right">0.5</td>
<td align="left">No Covariate A</td>
<td align="left">No Covariate C</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.05</td>
<td align="right">0.0105100</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">0.5</td>
<td align="left">No Covariate A</td>
<td align="left">No Covariate C</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.06</td>
<td align="right">0.0056736</td>
</tr>
<tr class="odd">
<td align="right">750</td>
<td align="right">0.5</td>
<td align="left">No Covariate A</td>
<td align="left">No Covariate C</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.03</td>
<td align="right">0.0201218</td>
</tr>
<tr class="even">
<td align="right">1000</td>
<td align="right">0.5</td>
<td align="left">No Covariate A</td>
<td align="left">No Covariate C</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0089694</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">1.0</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">No Covariate C</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.02</td>
<td align="right">0.0045342</td>
</tr>
<tr class="even">
<td align="right">250</td>
<td align="right">1.0</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">No Covariate C</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.06</td>
<td align="right">0.0038589</td>
</tr>
<tr class="odd">
<td align="right">500</td>
<td align="right">1.0</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">No Covariate C</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0018504</td>
</tr>
<tr class="even">
<td align="right">750</td>
<td align="right">1.0</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">No Covariate C</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0238725</td>
</tr>
<tr class="odd">
<td align="right">1000</td>
<td align="right">1.0</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">No Covariate C</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.05</td>
<td align="right">0.0105100</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="right">0.5</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">No Covariate C</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.06</td>
<td align="right">0.0056736</td>
</tr>
<tr class="odd">
<td align="right">250</td>
<td align="right">0.5</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">No Covariate C</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.03</td>
<td align="right">0.0201218</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">0.5</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">No Covariate C</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0089694</td>
</tr>
<tr class="odd">
<td align="right">750</td>
<td align="right">0.5</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">No Covariate C</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.02</td>
<td align="right">0.0045342</td>
</tr>
<tr class="even">
<td align="right">1000</td>
<td align="right">0.5</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">No Covariate C</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.06</td>
<td align="right">0.0038589</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">1.0</td>
<td align="left">No Covariate A</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0018504</td>
</tr>
<tr class="even">
<td align="right">250</td>
<td align="right">1.0</td>
<td align="left">No Covariate A</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0238725</td>
</tr>
<tr class="odd">
<td align="right">500</td>
<td align="right">1.0</td>
<td align="left">No Covariate A</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.05</td>
<td align="right">0.0105100</td>
</tr>
<tr class="even">
<td align="right">750</td>
<td align="right">1.0</td>
<td align="left">No Covariate A</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.06</td>
<td align="right">0.0056736</td>
</tr>
<tr class="odd">
<td align="right">1000</td>
<td align="right">1.0</td>
<td align="left">No Covariate A</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.03</td>
<td align="right">0.0201218</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="right">0.5</td>
<td align="left">No Covariate A</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0089694</td>
</tr>
<tr class="odd">
<td align="right">250</td>
<td align="right">0.5</td>
<td align="left">No Covariate A</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.02</td>
<td align="right">0.0045342</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">0.5</td>
<td align="left">No Covariate A</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.06</td>
<td align="right">0.0038589</td>
</tr>
<tr class="odd">
<td align="right">750</td>
<td align="right">0.5</td>
<td align="left">No Covariate A</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0018504</td>
</tr>
<tr class="even">
<td align="right">1000</td>
<td align="right">0.5</td>
<td align="left">No Covariate A</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0238725</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">1.0</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.05</td>
<td align="right">0.0105100</td>
</tr>
<tr class="even">
<td align="right">250</td>
<td align="right">1.0</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.06</td>
<td align="right">0.0056736</td>
</tr>
<tr class="odd">
<td align="right">500</td>
<td align="right">1.0</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.03</td>
<td align="right">0.0201218</td>
</tr>
<tr class="even">
<td align="right">750</td>
<td align="right">1.0</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0089694</td>
</tr>
<tr class="odd">
<td align="right">1000</td>
<td align="right">1.0</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.02</td>
<td align="right">0.0045342</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="right">0.5</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.06</td>
<td align="right">0.0038589</td>
</tr>
<tr class="odd">
<td align="right">250</td>
<td align="right">0.5</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0018504</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">0.5</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.04</td>
<td align="right">0.0238725</td>
</tr>
<tr class="odd">
<td align="right">750</td>
<td align="right">0.5</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.05</td>
<td align="right">0.0105100</td>
</tr>
<tr class="even">
<td align="right">1000</td>
<td align="right">0.5</td>
<td align="left">Covariate A (0.25)</td>
<td align="left">Covariate C (0.25)</td>
<td align="left">Covariate E (0.25)</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.06</td>
<td align="right">0.0056736</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h3>
<p>This vignette demonstrates how to conduct a simulation-based power
analysis for discordant sibling designs using the <code>discord</code>
package. By varying genetic relatedness, ACE variance components, and
covariate settings, we can assess the power of our designs to detect
causal effects. The results highlight the importance of sample size and
relatedness level in achieving sufficient power for these analyses.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by S. Mason Garrison, Jonathan Trattner, Yoo Ri Hwang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
